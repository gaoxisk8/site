<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta property="og:site_name" content="Xi Gao" />
    <meta property="og:url" content="https://gaoxi.us">
    <meta name="og:description" content="The professional homepage of Xi Gao.">
    <meta name="robots" content="noindex,nofollow">
    <link rel='icon' href='./resources/img/logo/favicon/favicon_io/favicon.ico' type='image/x-icon' />
    <!-- Stylesheets -->
    <link
        href="https://fonts.googleapis.com/css?family=Lato:300,400,400i,700|Poppins:300,400,500,600,700|PT+Serif:400,400i&display=swap"
        rel="stylesheet" type="text/css" />
    <link href="../node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./resources/css/style.css" type="text/css" />
    <link rel="stylesheet" href="./resources/css/dark.css" type="text/css" />
    <link rel="stylesheet" href="./resources/css/font-icons.css" type="text/css" />
    <link rel="stylesheet" href="./resources/css/animate.css" type="text/css" />
    <link rel="stylesheet" href="./resources/css/magnific-popup.css" type="text/css" />
    <link rel="stylesheet" href="./resources/css/custom.css" type="text/css" />
    <link href="./resources/css/my_style.css" rel="stylesheet">
    <link href="./resources/css/my.css" rel="stylesheet">
    <!-- JavaScripts -->
    <script src="../node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="../node_modules/jquery/dist/jquery.min.js"></script>
    <script src="./resources/js/plugins.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
        integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous">
        </script>
    <script src="../node_modules/d3/dist/d3.min.js"></script>
    <!-- Document Title -->
    <title>Noodles | Xi Gao</title>
</head>

<body>
   <!-- Document Wrapper -->
	<div id="wrapper_noodles" class="clearfix">

		<!-- Header -->
		<header id="header" class="full-header">
			<div id="header-wrap">
				<div class="container">
					<div class="header-row p-3">
						<!-- Logo -->
						<div id="logo">
							<a href="index.html" class="standard-logo"
								data-dark-logo="img/logo/homepage_header_logo.png"><img
									src="./resources/img/logo/homepage_header_logo.png" alt="Gaoxi Logo"></a>
							<a href="index.html" class="retina-logo"
								data-dark-logo="img/logo/homepage_header_logo@2.png"><img
									src="./resources/img/logo/homepage_header_logo@2.png" alt="Gaoxi Logo"></a>
						</div>
						<!-- #logo end -->

						<div id="primary-menu-trigger">
							<svg class="svg-trigger" viewBox="0 0 100 100">
								<path
									d="m 30,33 h 40 c 3.722839,0 7.5,3.126468 7.5,8.578427 0,5.451959 -2.727029,8.421573 -7.5,8.421573 h -20">
								</path>
								<path d="m 30,50 h 40"></path>
								<path
									d="m 70,67 h -40 c 0,0 -7.5,-0.802118 -7.5,-8.365747 0,-7.563629 7.5,-8.634253 7.5,-8.634253 h 20">
								</path>
							</svg>
						</div>

						<!-- Primary Navigation -->
						<nav class="primary-menu">

							<ul class="menu-container">
								<li class="menu-item current">
									<a class="menu-link " href="../index.html">
										PROJECT
									</a>
									<ul class="sub-menu-container">
										<li class="menu-item current">
											<a class="menu-link">NOODLES</a>
										</li>
										<li class="menu-item ">
											<a class="menu-link" href="../yarn.html">YARN</a>
										</li>
										<li class="menu-item">
											<a class="menu-link" href="../yoga.html">YOGA</a>
										</li>
										<li class="menu-item">
											<a class="menu-link" href="../plant.html">PLANT</a>
										</li>
									</ul>
								</li>
								<li class="menu-item">
									<a class="menu-link" href="../about.html">
										ABOUT
									</a>
								</li>
							</ul>
						</nav>
						<!-- #primary-menu end -->
						<form class="top-search-form" action="search.html" method="get">
							<input type="text" name="q" class="form-control" value=""
								placeholder="Type &amp; Hit Enter.." autocomplete="off">
						</form>

					</div>
				</div>
			</div>
			<div class="header-wrap-clone"></div>
		</header>
		<!-- #header end -->
		<!-- Page Title-->
		<section id="page-title">

			<div class="container">
				<div class="heading-block center border-bottom-0">
					<h2>Relationships Between Noodles</h2>
					<span>
						The raw data in csv format can be downloaded from <a href="./resources/data/noodles.csv" style="color: steelblue;">here</a>.
					</span>
                    <span>
                        We have used <a href="https://webwebpage.github.io/" style="color: steelblue;">the webweb</a> to visualize the network.
                    </span>                    
				</div>
                <div id="for_webweb"></div>
                
			</div>

		</section>
		<!-- #page-title end -->

		<!-- Content -->
        <!-- <div id="grab_this"></div> -->
        <script type="text/javascript">// color specifications and designs developed by Cynthia Brewer (http://colorbrewer.org/)
            var colorbrewer = {
                YlGn: {
                    2: ["#f7fcb9", "#addd8e"],
                    3: ["#f7fcb9", "#addd8e", "#31a354"],
                    4: ["#ffffcc", "#c2e699", "#78c679", "#238443"],
                    5: ["#ffffcc", "#c2e699", "#78c679", "#31a354", "#006837"],
                    6: ["#ffffcc", "#d9f0a3", "#addd8e", "#78c679", "#31a354", "#006837"],
                    7: ["#ffffcc", "#d9f0a3", "#addd8e", "#78c679", "#41ab5d", "#238443", "#005a32"],
                    8: ["#ffffe5", "#f7fcb9", "#d9f0a3", "#addd8e", "#78c679", "#41ab5d", "#238443", "#005a32"],
                    9: ["#ffffe5", "#f7fcb9", "#d9f0a3", "#addd8e", "#78c679", "#41ab5d", "#238443", "#006837", "#004529"]
                },
                YlGnBu: {
                    2: ["#edf8b1", "#7fcdbb"],
                    3: ["#edf8b1", "#7fcdbb", "#2c7fb8"],
                    4: ["#ffffcc", "#a1dab4", "#41b6c4", "#225ea8"],
                    5: ["#ffffcc", "#a1dab4", "#41b6c4", "#2c7fb8", "#253494"],
                    6: ["#ffffcc", "#c7e9b4", "#7fcdbb", "#41b6c4", "#2c7fb8", "#253494"],
                    7: ["#ffffcc", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#0c2c84"],
                    8: ["#ffffd9", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#0c2c84"],
                    9: ["#ffffd9", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58"]
                },
                GnBu: {
                    2: ["#e0f3db", "#a8ddb5"],
                    3: ["#e0f3db", "#a8ddb5", "#43a2ca"],
                    4: ["#f0f9e8", "#bae4bc", "#7bccc4", "#2b8cbe"],
                    5: ["#f0f9e8", "#bae4bc", "#7bccc4", "#43a2ca", "#0868ac"],
                    6: ["#f0f9e8", "#ccebc5", "#a8ddb5", "#7bccc4", "#43a2ca", "#0868ac"],
                    7: ["#f0f9e8", "#ccebc5", "#a8ddb5", "#7bccc4", "#4eb3d3", "#2b8cbe", "#08589e"],
                    8: ["#f7fcf0", "#e0f3db", "#ccebc5", "#a8ddb5", "#7bccc4", "#4eb3d3", "#2b8cbe", "#08589e"],
                    9: ["#f7fcf0", "#e0f3db", "#ccebc5", "#a8ddb5", "#7bccc4", "#4eb3d3", "#2b8cbe", "#0868ac", "#084081"]
                },
                BuGn: {
                    2: ["#e5f5f9", "#99d8c9"],
                    3: ["#e5f5f9", "#99d8c9", "#2ca25f"],
                    4: ["#edf8fb", "#b2e2e2", "#66c2a4", "#238b45"],
                    5: ["#edf8fb", "#b2e2e2", "#66c2a4", "#2ca25f", "#006d2c"],
                    6: ["#edf8fb", "#ccece6", "#99d8c9", "#66c2a4", "#2ca25f", "#006d2c"],
                    7: ["#edf8fb", "#ccece6", "#99d8c9", "#66c2a4", "#41ae76", "#238b45", "#005824"],
                    8: ["#f7fcfd", "#e5f5f9", "#ccece6", "#99d8c9", "#66c2a4", "#41ae76", "#238b45", "#005824"],
                    9: ["#f7fcfd", "#e5f5f9", "#ccece6", "#99d8c9", "#66c2a4", "#41ae76", "#238b45", "#006d2c", "#00441b"]
                },
                PuBuGn: {
                    2: ["#ece2f0", "#a6bddb"],
                    3: ["#ece2f0", "#a6bddb", "#1c9099"],
                    4: ["#f6eff7", "#bdc9e1", "#67a9cf", "#02818a"],
                    5: ["#f6eff7", "#bdc9e1", "#67a9cf", "#1c9099", "#016c59"],
                    6: ["#f6eff7", "#d0d1e6", "#a6bddb", "#67a9cf", "#1c9099", "#016c59"],
                    7: ["#f6eff7", "#d0d1e6", "#a6bddb", "#67a9cf", "#3690c0", "#02818a", "#016450"],
                    8: ["#fff7fb", "#ece2f0", "#d0d1e6", "#a6bddb", "#67a9cf", "#3690c0", "#02818a", "#016450"],
                    9: ["#fff7fb", "#ece2f0", "#d0d1e6", "#a6bddb", "#67a9cf", "#3690c0", "#02818a", "#016c59", "#014636"]
                },
                PuBu: {
                    2: ["#ece7f2", "#a6bddb"],
                    3: ["#ece7f2", "#a6bddb", "#2b8cbe"],
                    4: ["#f1eef6", "#bdc9e1", "#74a9cf", "#0570b0"],
                    5: ["#f1eef6", "#bdc9e1", "#74a9cf", "#2b8cbe", "#045a8d"],
                    6: ["#f1eef6", "#d0d1e6", "#a6bddb", "#74a9cf", "#2b8cbe", "#045a8d"],
                    7: ["#f1eef6", "#d0d1e6", "#a6bddb", "#74a9cf", "#3690c0", "#0570b0", "#034e7b"],
                    8: ["#fff7fb", "#ece7f2", "#d0d1e6", "#a6bddb", "#74a9cf", "#3690c0", "#0570b0", "#034e7b"],
                    9: ["#fff7fb", "#ece7f2", "#d0d1e6", "#a6bddb", "#74a9cf", "#3690c0", "#0570b0", "#045a8d", "#023858"]
                },
                BuPu: {
                    2: ["#e0ecf4", "#9ebcda"],
                    3: ["#e0ecf4", "#9ebcda", "#8856a7"],
                    4: ["#edf8fb", "#b3cde3", "#8c96c6", "#88419d"],
                    5: ["#edf8fb", "#b3cde3", "#8c96c6", "#8856a7", "#810f7c"],
                    6: ["#edf8fb", "#bfd3e6", "#9ebcda", "#8c96c6", "#8856a7", "#810f7c"],
                    7: ["#edf8fb", "#bfd3e6", "#9ebcda", "#8c96c6", "#8c6bb1", "#88419d", "#6e016b"],
                    8: ["#f7fcfd", "#e0ecf4", "#bfd3e6", "#9ebcda", "#8c96c6", "#8c6bb1", "#88419d", "#6e016b"],
                    9: ["#f7fcfd", "#e0ecf4", "#bfd3e6", "#9ebcda", "#8c96c6", "#8c6bb1", "#88419d", "#810f7c", "#4d004b"]
                },
                RdPu: {
                    2: ["#fde0dd", "#fa9fb5"],
                    3: ["#fde0dd", "#fa9fb5", "#c51b8a"],
                    4: ["#feebe2", "#fbb4b9", "#f768a1", "#ae017e"],
                    5: ["#feebe2", "#fbb4b9", "#f768a1", "#c51b8a", "#7a0177"],
                    6: ["#feebe2", "#fcc5c0", "#fa9fb5", "#f768a1", "#c51b8a", "#7a0177"],
                    7: ["#feebe2", "#fcc5c0", "#fa9fb5", "#f768a1", "#dd3497", "#ae017e", "#7a0177"],
                    8: ["#fff7f3", "#fde0dd", "#fcc5c0", "#fa9fb5", "#f768a1", "#dd3497", "#ae017e", "#7a0177"],
                    9: ["#fff7f3", "#fde0dd", "#fcc5c0", "#fa9fb5", "#f768a1", "#dd3497", "#ae017e", "#7a0177", "#49006a"]
                },
                PuRd: {
                    2: ["#e7e1ef", "#c994c7"],
                    3: ["#e7e1ef", "#c994c7", "#dd1c77"],
                    4: ["#f1eef6", "#d7b5d8", "#df65b0", "#ce1256"],
                    5: ["#f1eef6", "#d7b5d8", "#df65b0", "#dd1c77", "#980043"],
                    6: ["#f1eef6", "#d4b9da", "#c994c7", "#df65b0", "#dd1c77", "#980043"],
                    7: ["#f1eef6", "#d4b9da", "#c994c7", "#df65b0", "#e7298a", "#ce1256", "#91003f"],
                    8: ["#f7f4f9", "#e7e1ef", "#d4b9da", "#c994c7", "#df65b0", "#e7298a", "#ce1256", "#91003f"],
                    9: ["#f7f4f9", "#e7e1ef", "#d4b9da", "#c994c7", "#df65b0", "#e7298a", "#ce1256", "#980043", "#67001f"]
                },
                OrRd: {
                    2: ["#fee8c8", "#fdbb84"],
                    3: ["#fee8c8", "#fdbb84", "#e34a33"],
                    4: ["#fef0d9", "#fdcc8a", "#fc8d59", "#d7301f"],
                    5: ["#fef0d9", "#fdcc8a", "#fc8d59", "#e34a33", "#b30000"],
                    6: ["#fef0d9", "#fdd49e", "#fdbb84", "#fc8d59", "#e34a33", "#b30000"],
                    7: ["#fef0d9", "#fdd49e", "#fdbb84", "#fc8d59", "#ef6548", "#d7301f", "#990000"],
                    8: ["#fff7ec", "#fee8c8", "#fdd49e", "#fdbb84", "#fc8d59", "#ef6548", "#d7301f", "#990000"],
                    9: ["#fff7ec", "#fee8c8", "#fdd49e", "#fdbb84", "#fc8d59", "#ef6548", "#d7301f", "#b30000", "#7f0000"]
                },
                YlOrRd: {
                    2: ["#ffeda0", "#feb24c"],
                    3: ["#ffeda0", "#feb24c", "#f03b20"],
                    4: ["#ffffb2", "#fecc5c", "#fd8d3c", "#e31a1c"],
                    5: ["#ffffb2", "#fecc5c", "#fd8d3c", "#f03b20", "#bd0026"],
                    6: ["#ffffb2", "#fed976", "#feb24c", "#fd8d3c", "#f03b20", "#bd0026"],
                    7: ["#ffffb2", "#fed976", "#feb24c", "#fd8d3c", "#fc4e2a", "#e31a1c", "#b10026"],
                    8: ["#ffffcc", "#ffeda0", "#fed976", "#feb24c", "#fd8d3c", "#fc4e2a", "#e31a1c", "#b10026"],
                    9: ["#ffffcc", "#ffeda0", "#fed976", "#feb24c", "#fd8d3c", "#fc4e2a", "#e31a1c", "#bd0026", "#800026"]
                },
                YlOrBr: {
                    2: ["#fff7bc", "#fec44f"],
                    3: ["#fff7bc", "#fec44f", "#d95f0e"],
                    4: ["#ffffd4", "#fed98e", "#fe9929", "#cc4c02"],
                    5: ["#ffffd4", "#fed98e", "#fe9929", "#d95f0e", "#993404"],
                    6: ["#ffffd4", "#fee391", "#fec44f", "#fe9929", "#d95f0e", "#993404"],
                    7: ["#ffffd4", "#fee391", "#fec44f", "#fe9929", "#ec7014", "#cc4c02", "#8c2d04"],
                    8: ["#ffffe5", "#fff7bc", "#fee391", "#fec44f", "#fe9929", "#ec7014", "#cc4c02", "#8c2d04"],
                    9: ["#ffffe5", "#fff7bc", "#fee391", "#fec44f", "#fe9929", "#ec7014", "#cc4c02", "#993404", "#662506"]
                },
                Purples: {
                    2: ["#efedf5", "#bcbddc"],
                    3: ["#efedf5", "#bcbddc", "#756bb1"],
                    4: ["#f2f0f7", "#cbc9e2", "#9e9ac8", "#6a51a3"],
                    5: ["#f2f0f7", "#cbc9e2", "#9e9ac8", "#756bb1", "#54278f"],
                    6: ["#f2f0f7", "#dadaeb", "#bcbddc", "#9e9ac8", "#756bb1", "#54278f"],
                    7: ["#f2f0f7", "#dadaeb", "#bcbddc", "#9e9ac8", "#807dba", "#6a51a3", "#4a1486"],
                    8: ["#fcfbfd", "#efedf5", "#dadaeb", "#bcbddc", "#9e9ac8", "#807dba", "#6a51a3", "#4a1486"],
                    9: ["#fcfbfd", "#efedf5", "#dadaeb", "#bcbddc", "#9e9ac8", "#807dba", "#6a51a3", "#54278f", "#3f007d"]
                },
                Blues: {
                    2: ["#deebf7", "#9ecae1"],
                    3: ["#deebf7", "#9ecae1", "#3182bd"],
                    4: ["#eff3ff", "#bdd7e7", "#6baed6", "#2171b5"],
                    5: ["#eff3ff", "#bdd7e7", "#6baed6", "#3182bd", "#08519c"],
                    6: ["#eff3ff", "#c6dbef", "#9ecae1", "#6baed6", "#3182bd", "#08519c"],
                    7: ["#eff3ff", "#c6dbef", "#9ecae1", "#6baed6", "#4292c6", "#2171b5", "#084594"],
                    8: ["#f7fbff", "#deebf7", "#c6dbef", "#9ecae1", "#6baed6", "#4292c6", "#2171b5", "#084594"],
                    9: ["#f7fbff", "#deebf7", "#c6dbef", "#9ecae1", "#6baed6", "#4292c6", "#2171b5", "#08519c", "#08306b"]
                },
                Greens: {
                    2: ["#e5f5e0", "#a1d99b"],
                    3: ["#e5f5e0", "#a1d99b", "#31a354"],
                    4: ["#edf8e9", "#bae4b3", "#74c476", "#238b45"],
                    5: ["#edf8e9", "#bae4b3", "#74c476", "#31a354", "#006d2c"],
                    6: ["#edf8e9", "#c7e9c0", "#a1d99b", "#74c476", "#31a354", "#006d2c"],
                    7: ["#edf8e9", "#c7e9c0", "#a1d99b", "#74c476", "#41ab5d", "#238b45", "#005a32"],
                    8: ["#f7fcf5", "#e5f5e0", "#c7e9c0", "#a1d99b", "#74c476", "#41ab5d", "#238b45", "#005a32"],
                    9: ["#f7fcf5", "#e5f5e0", "#c7e9c0", "#a1d99b", "#74c476", "#41ab5d", "#238b45", "#006d2c", "#00441b"]
                },
                Oranges: {
                    2: ["#fee6ce", "#fdae6b"],
                    3: ["#fee6ce", "#fdae6b", "#e6550d"],
                    4: ["#feedde", "#fdbe85", "#fd8d3c", "#d94701"],
                    5: ["#feedde", "#fdbe85", "#fd8d3c", "#e6550d", "#a63603"],
                    6: ["#feedde", "#fdd0a2", "#fdae6b", "#fd8d3c", "#e6550d", "#a63603"],
                    7: ["#feedde", "#fdd0a2", "#fdae6b", "#fd8d3c", "#f16913", "#d94801", "#8c2d04"],
                    8: ["#fff5eb", "#fee6ce", "#fdd0a2", "#fdae6b", "#fd8d3c", "#f16913", "#d94801", "#8c2d04"],
                    9: ["#fff5eb", "#fee6ce", "#fdd0a2", "#fdae6b", "#fd8d3c", "#f16913", "#d94801", "#a63603", "#7f2704"]
                },
                Reds: {
                    2: ["#fee0d2", "#fc9272"],
                    3: ["#fee0d2", "#fc9272", "#de2d26"],
                    4: ["#fee5d9", "#fcae91", "#fb6a4a", "#cb181d"],
                    5: ["#fee5d9", "#fcae91", "#fb6a4a", "#de2d26", "#a50f15"],
                    6: ["#fee5d9", "#fcbba1", "#fc9272", "#fb6a4a", "#de2d26", "#a50f15"],
                    7: ["#fee5d9", "#fcbba1", "#fc9272", "#fb6a4a", "#ef3b2c", "#cb181d", "#99000d"],
                    8: ["#fff5f0", "#fee0d2", "#fcbba1", "#fc9272", "#fb6a4a", "#ef3b2c", "#cb181d", "#99000d"],
                    9: ["#fff5f0", "#fee0d2", "#fcbba1", "#fc9272", "#fb6a4a", "#ef3b2c", "#cb181d", "#a50f15", "#67000d"]
                },
                Greys: {
                    2: ["#f0f0f0", "#bdbdbd"],
                    3: ["#f0f0f0", "#bdbdbd", "#636363"],
                    4: ["#f7f7f7", "#cccccc", "#969696", "#525252"],
                    5: ["#f7f7f7", "#cccccc", "#969696", "#636363", "#252525"],
                    6: ["#f7f7f7", "#d9d9d9", "#bdbdbd", "#969696", "#636363", "#252525"],
                    7: ["#f7f7f7", "#d9d9d9", "#bdbdbd", "#969696", "#737373", "#525252", "#252525"],
                    8: ["#ffffff", "#f0f0f0", "#d9d9d9", "#bdbdbd", "#969696", "#737373", "#525252", "#252525"],
                    9: ["#ffffff", "#f0f0f0", "#d9d9d9", "#bdbdbd", "#969696", "#737373", "#525252", "#252525", "#000000"]
                },
                PuOr: {
                    2: ["#f1a340", "#f7f7f7"],
                    3: ["#f1a340", "#f7f7f7", "#998ec3"],
                    4: ["#e66101", "#fdb863", "#b2abd2", "#5e3c99"],
                    5: ["#e66101", "#fdb863", "#f7f7f7", "#b2abd2", "#5e3c99"],
                    6: ["#b35806", "#f1a340", "#fee0b6", "#d8daeb", "#998ec3", "#542788"],
                    7: ["#b35806", "#f1a340", "#fee0b6", "#f7f7f7", "#d8daeb", "#998ec3", "#542788"],
                    8: ["#b35806", "#e08214", "#fdb863", "#fee0b6", "#d8daeb", "#b2abd2", "#8073ac", "#542788"],
                    9: ["#b35806", "#e08214", "#fdb863", "#fee0b6", "#f7f7f7", "#d8daeb", "#b2abd2", "#8073ac", "#542788"],
                    10: ["#7f3b08", "#b35806", "#e08214", "#fdb863", "#fee0b6", "#d8daeb", "#b2abd2", "#8073ac", "#542788", "#2d004b"],
                    11: ["#7f3b08", "#b35806", "#e08214", "#fdb863", "#fee0b6", "#f7f7f7", "#d8daeb", "#b2abd2", "#8073ac", "#542788", "#2d004b"]
                },
                BrBG: {
                    2: ["#d8b365", "#f5f5f5"],
                    3: ["#d8b365", "#f5f5f5", "#5ab4ac"],
                    4: ["#a6611a", "#dfc27d", "#80cdc1", "#018571"],
                    5: ["#a6611a", "#dfc27d", "#f5f5f5", "#80cdc1", "#018571"],
                    6: ["#8c510a", "#d8b365", "#f6e8c3", "#c7eae5", "#5ab4ac", "#01665e"],
                    7: ["#8c510a", "#d8b365", "#f6e8c3", "#f5f5f5", "#c7eae5", "#5ab4ac", "#01665e"],
                    8: ["#8c510a", "#bf812d", "#dfc27d", "#f6e8c3", "#c7eae5", "#80cdc1", "#35978f", "#01665e"],
                    9: ["#8c510a", "#bf812d", "#dfc27d", "#f6e8c3", "#f5f5f5", "#c7eae5", "#80cdc1", "#35978f", "#01665e"],
                    10: ["#543005", "#8c510a", "#bf812d", "#dfc27d", "#f6e8c3", "#c7eae5", "#80cdc1", "#35978f", "#01665e", "#003c30"],
                    11: ["#543005", "#8c510a", "#bf812d", "#dfc27d", "#f6e8c3", "#f5f5f5", "#c7eae5", "#80cdc1", "#35978f", "#01665e", "#003c30"]
                },
                PRGn: {
                    2: ["#af8dc3", "#f7f7f7"],
                    3: ["#af8dc3", "#f7f7f7", "#7fbf7b"],
                    4: ["#7b3294", "#c2a5cf", "#a6dba0", "#008837"],
                    5: ["#7b3294", "#c2a5cf", "#f7f7f7", "#a6dba0", "#008837"],
                    6: ["#762a83", "#af8dc3", "#e7d4e8", "#d9f0d3", "#7fbf7b", "#1b7837"],
                    7: ["#762a83", "#af8dc3", "#e7d4e8", "#f7f7f7", "#d9f0d3", "#7fbf7b", "#1b7837"],
                    8: ["#762a83", "#9970ab", "#c2a5cf", "#e7d4e8", "#d9f0d3", "#a6dba0", "#5aae61", "#1b7837"],
                    9: ["#762a83", "#9970ab", "#c2a5cf", "#e7d4e8", "#f7f7f7", "#d9f0d3", "#a6dba0", "#5aae61", "#1b7837"],
                    10: ["#40004b", "#762a83", "#9970ab", "#c2a5cf", "#e7d4e8", "#d9f0d3", "#a6dba0", "#5aae61", "#1b7837", "#00441b"],
                    11: ["#40004b", "#762a83", "#9970ab", "#c2a5cf", "#e7d4e8", "#f7f7f7", "#d9f0d3", "#a6dba0", "#5aae61", "#1b7837", "#00441b"]
                },
                PiYG: {
                    2: ["#e9a3c9", "#f7f7f7"],
                    3: ["#e9a3c9", "#f7f7f7", "#a1d76a"],
                    4: ["#d01c8b", "#f1b6da", "#b8e186", "#4dac26"],
                    5: ["#d01c8b", "#f1b6da", "#f7f7f7", "#b8e186", "#4dac26"],
                    6: ["#c51b7d", "#e9a3c9", "#fde0ef", "#e6f5d0", "#a1d76a", "#4d9221"],
                    7: ["#c51b7d", "#e9a3c9", "#fde0ef", "#f7f7f7", "#e6f5d0", "#a1d76a", "#4d9221"],
                    8: ["#c51b7d", "#de77ae", "#f1b6da", "#fde0ef", "#e6f5d0", "#b8e186", "#7fbc41", "#4d9221"],
                    9: ["#c51b7d", "#de77ae", "#f1b6da", "#fde0ef", "#f7f7f7", "#e6f5d0", "#b8e186", "#7fbc41", "#4d9221"],
                    10: ["#8e0152", "#c51b7d", "#de77ae", "#f1b6da", "#fde0ef", "#e6f5d0", "#b8e186", "#7fbc41", "#4d9221", "#276419"],
                    11: ["#8e0152", "#c51b7d", "#de77ae", "#f1b6da", "#fde0ef", "#f7f7f7", "#e6f5d0", "#b8e186", "#7fbc41", "#4d9221", "#276419"]
                },
                RdBu: {
                    2: ["#ef8a62", "#f7f7f7"],
                    3: ["#ef8a62", "#f7f7f7", "#67a9cf"],
                    4: ["#ca0020", "#f4a582", "#92c5de", "#0571b0"],
                    5: ["#ca0020", "#f4a582", "#f7f7f7", "#92c5de", "#0571b0"],
                    6: ["#b2182b", "#ef8a62", "#fddbc7", "#d1e5f0", "#67a9cf", "#2166ac"],
                    7: ["#b2182b", "#ef8a62", "#fddbc7", "#f7f7f7", "#d1e5f0", "#67a9cf", "#2166ac"],
                    8: ["#b2182b", "#d6604d", "#f4a582", "#fddbc7", "#d1e5f0", "#92c5de", "#4393c3", "#2166ac"],
                    9: ["#b2182b", "#d6604d", "#f4a582", "#fddbc7", "#f7f7f7", "#d1e5f0", "#92c5de", "#4393c3", "#2166ac"],
                    10: ["#67001f", "#b2182b", "#d6604d", "#f4a582", "#fddbc7", "#d1e5f0", "#92c5de", "#4393c3", "#2166ac", "#053061"],
                    11: ["#67001f", "#b2182b", "#d6604d", "#f4a582", "#fddbc7", "#f7f7f7", "#d1e5f0", "#92c5de", "#4393c3", "#2166ac", "#053061"]
                },
                RdGy: {
                    2: ["#ef8a62", "#ffffff"],
                    3: ["#ef8a62", "#ffffff", "#999999"],
                    4: ["#ca0020", "#f4a582", "#bababa", "#404040"],
                    5: ["#ca0020", "#f4a582", "#ffffff", "#bababa", "#404040"],
                    6: ["#b2182b", "#ef8a62", "#fddbc7", "#e0e0e0", "#999999", "#4d4d4d"],
                    7: ["#b2182b", "#ef8a62", "#fddbc7", "#ffffff", "#e0e0e0", "#999999", "#4d4d4d"],
                    8: ["#b2182b", "#d6604d", "#f4a582", "#fddbc7", "#e0e0e0", "#bababa", "#878787", "#4d4d4d"],
                    9: ["#b2182b", "#d6604d", "#f4a582", "#fddbc7", "#ffffff", "#e0e0e0", "#bababa", "#878787", "#4d4d4d"],
                    10: ["#67001f", "#b2182b", "#d6604d", "#f4a582", "#fddbc7", "#e0e0e0", "#bababa", "#878787", "#4d4d4d", "#1a1a1a"],
                    11: ["#67001f", "#b2182b", "#d6604d", "#f4a582", "#fddbc7", "#ffffff", "#e0e0e0", "#bababa", "#878787", "#4d4d4d", "#1a1a1a"]
                },
                RdYlBu: {
                    2: ["#fc8d59", "#ffffbf"],
                    3: ["#fc8d59", "#ffffbf", "#91bfdb"],
                    4: ["#d7191c", "#fdae61", "#abd9e9", "#2c7bb6"],
                    5: ["#d7191c", "#fdae61", "#ffffbf", "#abd9e9", "#2c7bb6"],
                    6: ["#d73027", "#fc8d59", "#fee090", "#e0f3f8", "#91bfdb", "#4575b4"],
                    7: ["#d73027", "#fc8d59", "#fee090", "#ffffbf", "#e0f3f8", "#91bfdb", "#4575b4"],
                    8: ["#d73027", "#f46d43", "#fdae61", "#fee090", "#e0f3f8", "#abd9e9", "#74add1", "#4575b4"],
                    9: ["#d73027", "#f46d43", "#fdae61", "#fee090", "#ffffbf", "#e0f3f8", "#abd9e9", "#74add1", "#4575b4"],
                    10: ["#a50026", "#d73027", "#f46d43", "#fdae61", "#fee090", "#e0f3f8", "#abd9e9", "#74add1", "#4575b4", "#313695"],
                    11: ["#a50026", "#d73027", "#f46d43", "#fdae61", "#fee090", "#ffffbf", "#e0f3f8", "#abd9e9", "#74add1", "#4575b4", "#313695"]
                },
                Spectral: {
                    2: ["#fc8d59", "#ffffbf"],
                    3: ["#fc8d59", "#ffffbf", "#99d594"],
                    4: ["#d7191c", "#fdae61", "#abdda4", "#2b83ba"],
                    5: ["#d7191c", "#fdae61", "#ffffbf", "#abdda4", "#2b83ba"],
                    6: ["#d53e4f", "#fc8d59", "#fee08b", "#e6f598", "#99d594", "#3288bd"],
                    7: ["#d53e4f", "#fc8d59", "#fee08b", "#ffffbf", "#e6f598", "#99d594", "#3288bd"],
                    8: ["#d53e4f", "#f46d43", "#fdae61", "#fee08b", "#e6f598", "#abdda4", "#66c2a5", "#3288bd"],
                    9: ["#d53e4f", "#f46d43", "#fdae61", "#fee08b", "#ffffbf", "#e6f598", "#abdda4", "#66c2a5", "#3288bd"],
                    10: ["#9e0142", "#d53e4f", "#f46d43", "#fdae61", "#fee08b", "#e6f598", "#abdda4", "#66c2a5", "#3288bd", "#5e4fa2"],
                    11: ["#9e0142", "#d53e4f", "#f46d43", "#fdae61", "#fee08b", "#ffffbf", "#e6f598", "#abdda4", "#66c2a5", "#3288bd", "#5e4fa2"]
                },
                RdYlGn: {
                    2: ["#fc8d59", "#ffffbf"],
                    3: ["#fc8d59", "#ffffbf", "#91cf60"],
                    4: ["#d7191c", "#fdae61", "#a6d96a", "#1a9641"],
                    5: ["#d7191c", "#fdae61", "#ffffbf", "#a6d96a", "#1a9641"],
                    6: ["#d73027", "#fc8d59", "#fee08b", "#d9ef8b", "#91cf60", "#1a9850"],
                    7: ["#d73027", "#fc8d59", "#fee08b", "#ffffbf", "#d9ef8b", "#91cf60", "#1a9850"],
                    8: ["#d73027", "#f46d43", "#fdae61", "#fee08b", "#d9ef8b", "#a6d96a", "#66bd63", "#1a9850"],
                    9: ["#d73027", "#f46d43", "#fdae61", "#fee08b", "#ffffbf", "#d9ef8b", "#a6d96a", "#66bd63", "#1a9850"],
                    10: ["#a50026", "#d73027", "#f46d43", "#fdae61", "#fee08b", "#d9ef8b", "#a6d96a", "#66bd63", "#1a9850", "#006837"],
                    11: ["#a50026", "#d73027", "#f46d43", "#fdae61", "#fee08b", "#ffffbf", "#d9ef8b", "#a6d96a", "#66bd63", "#1a9850", "#006837"]
                },
                Accent: {
                    2: ["#7fc97f", "#beaed4"],
                    3: ["#7fc97f", "#beaed4", "#fdc086"],
                    4: ["#7fc97f", "#beaed4", "#fdc086", "#ffff99"],
                    5: ["#7fc97f", "#beaed4", "#fdc086", "#ffff99", "#386cb0"],
                    6: ["#7fc97f", "#beaed4", "#fdc086", "#ffff99", "#386cb0", "#f0027f"],
                    7: ["#7fc97f", "#beaed4", "#fdc086", "#ffff99", "#386cb0", "#f0027f", "#bf5b17"],
                    8: ["#7fc97f", "#beaed4", "#fdc086", "#ffff99", "#386cb0", "#f0027f", "#bf5b17", "#666666"]
                },
                Dark2: {
                    2: ["#1b9e77", "#d95f02"],
                    3: ["#1b9e77", "#d95f02", "#7570b3"],
                    4: ["#1b9e77", "#d95f02", "#7570b3", "#e7298a"],
                    5: ["#1b9e77", "#d95f02", "#7570b3", "#e7298a", "#66a61e"],
                    6: ["#1b9e77", "#d95f02", "#7570b3", "#e7298a", "#66a61e", "#e6ab02"],
                    7: ["#1b9e77", "#d95f02", "#7570b3", "#e7298a", "#66a61e", "#e6ab02", "#a6761d"],
                    8: ["#1b9e77", "#d95f02", "#7570b3", "#e7298a", "#66a61e", "#e6ab02", "#a6761d", "#666666"]
                },
                Paired: {
                    2: ["#a6cee3", "#1f78b4"],
                    3: ["#a6cee3", "#1f78b4", "#b2df8a"],
                    4: ["#a6cee3", "#1f78b4", "#b2df8a", "#33a02c"],
                    5: ["#a6cee3", "#1f78b4", "#b2df8a", "#33a02c", "#fb9a99"],
                    6: ["#a6cee3", "#1f78b4", "#b2df8a", "#33a02c", "#fb9a99", "#e31a1c"],
                    7: ["#a6cee3", "#1f78b4", "#b2df8a", "#33a02c", "#fb9a99", "#e31a1c", "#fdbf6f"],
                    8: ["#a6cee3", "#1f78b4", "#b2df8a", "#33a02c", "#fb9a99", "#e31a1c", "#fdbf6f", "#ff7f00"],
                    9: ["#a6cee3", "#1f78b4", "#b2df8a", "#33a02c", "#fb9a99", "#e31a1c", "#fdbf6f", "#ff7f00", "#cab2d6"],
                    10: ["#a6cee3", "#1f78b4", "#b2df8a", "#33a02c", "#fb9a99", "#e31a1c", "#fdbf6f", "#ff7f00", "#cab2d6", "#6a3d9a"],
                    11: ["#a6cee3", "#1f78b4", "#b2df8a", "#33a02c", "#fb9a99", "#e31a1c", "#fdbf6f", "#ff7f00", "#cab2d6", "#6a3d9a", "#ffff99"],
                    12: ["#a6cee3", "#1f78b4", "#b2df8a", "#33a02c", "#fb9a99", "#e31a1c", "#fdbf6f", "#ff7f00", "#cab2d6", "#6a3d9a", "#ffff99", "#b15928"]
                },
                Pastel1: {
                    2: ["#fbb4ae", "#b3cde3"],
                    3: ["#fbb4ae", "#b3cde3", "#ccebc5"],
                    4: ["#fbb4ae", "#b3cde3", "#ccebc5", "#decbe4"],
                    5: ["#fbb4ae", "#b3cde3", "#ccebc5", "#decbe4", "#fed9a6"],
                    6: ["#fbb4ae", "#b3cde3", "#ccebc5", "#decbe4", "#fed9a6", "#ffffcc"],
                    7: ["#fbb4ae", "#b3cde3", "#ccebc5", "#decbe4", "#fed9a6", "#ffffcc", "#e5d8bd"],
                    8: ["#fbb4ae", "#b3cde3", "#ccebc5", "#decbe4", "#fed9a6", "#ffffcc", "#e5d8bd", "#fddaec"],
                    9: ["#fbb4ae", "#b3cde3", "#ccebc5", "#decbe4", "#fed9a6", "#ffffcc", "#e5d8bd", "#fddaec", "#f2f2f2"]
                },
                Pastel2: {
                    2: ["#b3e2cd", "#fdcdac"],
                    3: ["#b3e2cd", "#fdcdac", "#cbd5e8"],
                    4: ["#b3e2cd", "#fdcdac", "#cbd5e8", "#f4cae4"],
                    5: ["#b3e2cd", "#fdcdac", "#cbd5e8", "#f4cae4", "#e6f5c9"],
                    6: ["#b3e2cd", "#fdcdac", "#cbd5e8", "#f4cae4", "#e6f5c9", "#fff2ae"],
                    7: ["#b3e2cd", "#fdcdac", "#cbd5e8", "#f4cae4", "#e6f5c9", "#fff2ae", "#f1e2cc"],
                    8: ["#b3e2cd", "#fdcdac", "#cbd5e8", "#f4cae4", "#e6f5c9", "#fff2ae", "#f1e2cc", "#cccccc"]
                },
                Set1: {
                    2: ["#e41a1c", "#4daf4a"],
                    3: ["#e41a1c", "#377eb8", "#4daf4a"],
                    4: ["#e41a1c", "#377eb8", "#4daf4a", "#984ea3"],
                    5: ["#e41a1c", "#377eb8", "#4daf4a", "#984ea3", "#ff7f00"],
                    6: ["#e41a1c", "#377eb8", "#4daf4a", "#984ea3", "#ff7f00", "#DBDB42"],
                    7: ["#e41a1c", "#377eb8", "#4daf4a", "#984ea3", "#ff7f00", "#DBDB42", "#a65628"],
                    8: ["#e41a1c", "#377eb8", "#4daf4a", "#984ea3", "#ff7f00", "#DBDB42", "#a65628", "#f781bf"],
                    9: ["#e41a1c", "#377eb8", "#4daf4a", "#984ea3", "#ff7f00", "#DBDB42", "#a65628", "#f781bf", "#999999"]
                },
                Set2: {
                    2: ["#66c2a5", "#fc8d62"],
                    3: ["#66c2a5", "#fc8d62", "#8da0cb"],
                    4: ["#66c2a5", "#fc8d62", "#8da0cb", "#e78ac3"],
                    5: ["#66c2a5", "#fc8d62", "#8da0cb", "#e78ac3", "#a6d854"],
                    6: ["#66c2a5", "#fc8d62", "#8da0cb", "#e78ac3", "#a6d854", "#ffd92f"],
                    7: ["#66c2a5", "#fc8d62", "#8da0cb", "#e78ac3", "#a6d854", "#ffd92f", "#e5c494"],
                    8: ["#66c2a5", "#fc8d62", "#8da0cb", "#e78ac3", "#a6d854", "#ffd92f", "#e5c494", "#b3b3b3"]
                },
                Set3: {
                    2: ["#8dd3c7", "#ffffb3"],
                    3: ["#8dd3c7", "#ffffb3", "#bebada"],
                    4: ["#8dd3c7", "#ffffb3", "#bebada", "#fb8072"],
                    5: ["#8dd3c7", "#ffffb3", "#bebada", "#fb8072", "#80b1d3"],
                    6: ["#8dd3c7", "#ffffb3", "#bebada", "#fb8072", "#80b1d3", "#fdb462"],
                    7: ["#8dd3c7", "#ffffb3", "#bebada", "#fb8072", "#80b1d3", "#fdb462", "#b3de69"],
                    8: ["#8dd3c7", "#ffffb3", "#bebada", "#fb8072", "#80b1d3", "#fdb462", "#b3de69", "#fccde5"],
                    9: ["#8dd3c7", "#ffffb3", "#bebada", "#fb8072", "#80b1d3", "#fdb462", "#b3de69", "#fccde5", "#d9d9d9"],
                    10: ["#8dd3c7", "#ffffb3", "#bebada", "#fb8072", "#80b1d3", "#fdb462", "#b3de69", "#fccde5", "#d9d9d9", "#bc80bd"],
                    11: ["#8dd3c7", "#ffffb3", "#bebada", "#fb8072", "#80b1d3", "#fdb462", "#b3de69", "#fccde5", "#d9d9d9", "#bc80bd", "#ccebc5"],
                    12: ["#8dd3c7", "#ffffb3", "#bebada", "#fb8072", "#80b1d3", "#fdb462", "#b3de69", "#fccde5", "#d9d9d9", "#bc80bd", "#ccebc5", "#ffed6f"]
                },
            };
        </script>
        <script type="text/javascript">/* Blob.js
    * A Blob implementation.
    * 2018-01-12
    *
    * By Eli Grey, http://eligrey.com
    * By Devin Samarin, https://github.com/dsamarin
    * License: MIT
    *   See https://github.com/eligrey/Blob.js/blob/master/LICENSE.md
    */
    
            /*global self, unescape */
            /*jslint bitwise: true, regexp: true, confusion: true, es5: true, vars: true, white: true,
              plusplus: true */
    
            /*! @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js */
    
            (function (view) {
                "use strict";
    
                view.URL = view.URL || view.webkitURL;
    
                if (view.Blob && view.URL) {
                    try {
                        new Blob;
                        return;
                    } catch (e) { }
                }
    
                // Internally we use a BlobBuilder implementation to base Blob off of
                // in order to support older browsers that only have BlobBuilder
                var BlobBuilder = view.BlobBuilder || view.WebKitBlobBuilder || view.MozBlobBuilder || (function (view) {
                    var
                        get_class = function (object) {
                            return Object.prototype.toString.call(object).match(/^\[object\s(.*)\]$/)[1];
                        }
                        , FakeBlobBuilder = function BlobBuilder() {
                            this.data = [];
                        }
                        , FakeBlob = function Blob(data, type, encoding) {
                            this.data = data;
                            this.size = data.length;
                            this.type = type;
                            this.encoding = encoding;
                        }
                        , FBB_proto = FakeBlobBuilder.prototype
                        , FB_proto = FakeBlob.prototype
                        , FileReaderSync = view.FileReaderSync
                        , FileException = function (type) {
                            this.code = this[this.name = type];
                        }
                        , file_ex_codes = (
                            "NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR "
                            + "NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR"
                        ).split(" ")
                        , file_ex_code = file_ex_codes.length
                        , real_URL = view.URL || view.webkitURL || view
                        , real_create_object_URL = real_URL.createObjectURL
                        , real_revoke_object_URL = real_URL.revokeObjectURL
                        , URL = real_URL
                        , btoa = view.btoa
                        , atob = view.atob
    
                        , ArrayBuffer = view.ArrayBuffer
                        , Uint8Array = view.Uint8Array
    
                        , origin = /^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/
                        ;
                    FakeBlob.fake = FB_proto.fake = true;
                    while (file_ex_code--) {
                        FileException.prototype[file_ex_codes[file_ex_code]] = file_ex_code + 1;
                    }
                    // Polyfill URL
                    if (!real_URL.createObjectURL) {
                        URL = view.URL = function (uri) {
                            var
                                uri_info = document.createElementNS("http://www.w3.org/1999/xhtml", "a")
                                , uri_origin
                                ;
                            uri_info.href = uri;
                            if (!("origin" in uri_info)) {
                                if (uri_info.protocol.toLowerCase() === "data:") {
                                    uri_info.origin = null;
                                } else {
                                    uri_origin = uri.match(origin);
                                    uri_info.origin = uri_origin && uri_origin[1];
                                }
                            }
                            return uri_info;
                        };
                    }
                    URL.createObjectURL = function (blob) {
                        var
                            type = blob.type
                            , data_URI_header
                            ;
                        if (type === null) {
                            type = "application/octet-stream";
                        }
                        if (blob instanceof FakeBlob) {
                            data_URI_header = "data:" + type;
                            if (blob.encoding === "base64") {
                                return data_URI_header + ";base64," + blob.data;
                            } else if (blob.encoding === "URI") {
                                return data_URI_header + "," + decodeURIComponent(blob.data);
                            } if (btoa) {
                                return data_URI_header + ";base64," + btoa(blob.data);
                            } else {
                                return data_URI_header + "," + encodeURIComponent(blob.data);
                            }
                        } else if (real_create_object_URL) {
                            return real_create_object_URL.call(real_URL, blob);
                        }
                    };
                    URL.revokeObjectURL = function (object_URL) {
                        if (object_URL.substring(0, 5) !== "data:" && real_revoke_object_URL) {
                            real_revoke_object_URL.call(real_URL, object_URL);
                        }
                    };
                    FBB_proto.append = function (data/*, endings*/) {
                        var bb = this.data;
                        // decode data to a binary string
                        if (Uint8Array && (data instanceof ArrayBuffer || data instanceof Uint8Array)) {
                            var
                                str = ""
                                , buf = new Uint8Array(data)
                                , i = 0
                                , buf_len = buf.length
                                ;
                            for (; i < buf_len; i++) {
                                str += String.fromCharCode(buf[i]);
                            }
                            bb.push(str);
                        } else if (get_class(data) === "Blob" || get_class(data) === "File") {
                            if (FileReaderSync) {
                                var fr = new FileReaderSync;
                                bb.push(fr.readAsBinaryString(data));
                            } else {
                                // async FileReader won't work as BlobBuilder is sync
                                throw new FileException("NOT_READABLE_ERR");
                            }
                        } else if (data instanceof FakeBlob) {
                            if (data.encoding === "base64" && atob) {
                                bb.push(atob(data.data));
                            } else if (data.encoding === "URI") {
                                bb.push(decodeURIComponent(data.data));
                            } else if (data.encoding === "raw") {
                                bb.push(data.data);
                            }
                        } else {
                            if (typeof data !== "string") {
                                data += ""; // convert unsupported types to strings
                            }
                            // decode UTF-16 to binary string
                            bb.push(unescape(encodeURIComponent(data)));
                        }
                    };
                    FBB_proto.getBlob = function (type) {
                        if (!arguments.length) {
                            type = null;
                        }
                        return new FakeBlob(this.data.join(""), type, "raw");
                    };
                    FBB_proto.toString = function () {
                        return "[object BlobBuilder]";
                    };
                    FB_proto.slice = function (start, end, type) {
                        var args = arguments.length;
                        if (args < 3) {
                            type = null;
                        }
                        return new FakeBlob(
                            this.data.slice(start, args > 1 ? end : this.data.length)
                            , type
                            , this.encoding
                        );
                    };
                    FB_proto.toString = function () {
                        return "[object Blob]";
                    };
                    FB_proto.close = function () {
                        this.size = 0;
                        delete this.data;
                    };
                    return FakeBlobBuilder;
                }(view));
    
                view.Blob = function (blobParts, options) {
                    var type = options ? (options.type || "") : "";
                    var builder = new BlobBuilder();
                    if (blobParts) {
                        for (var i = 0, len = blobParts.length; i < len; i++) {
                            if (Uint8Array && blobParts[i] instanceof Uint8Array) {
                                builder.append(blobParts[i].buffer);
                            }
                            else {
                                builder.append(blobParts[i]);
                            }
                        }
                    }
                    var blob = builder.getBlob(type);
                    if (!blob.slice && blob.webkitSlice) {
                        blob.slice = blob.webkitSlice;
                    }
                    return blob;
                };
    
                var getPrototypeOf = Object.getPrototypeOf || function (object) {
                    return object.__proto__;
                };
                view.Blob.prototype = getPrototypeOf(new view.Blob());
            }(
                typeof self !== "undefined" && self
                || typeof window !== "undefined" && window
                || this
            ));</script>
        <script type="text/javascript">/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
            var saveAs = saveAs || function (e) { "use strict"; if (!("undefined" == typeof e || "undefined" != typeof navigator && /MSIE [1-9]\./.test(navigator.userAgent))) { var t = e.document, n = function () { return e.URL || e.webkitURL || e }, o = t.createElementNS("http://www.w3.org/1999/xhtml", "a"), r = "download" in o, a = function (e) { var t = new MouseEvent("click"); e.dispatchEvent(t) }, i = /constructor/i.test(e.HTMLElement) || e.safari, d = /CriOS\/[\d]+/.test(navigator.userAgent), f = function (t) { (e.setImmediate || e.setTimeout)(function () { throw t }, 0) }, s = "application/octet-stream", u = 4e4, c = function (e) { var t = function () { "string" == typeof e ? n().revokeObjectURL(e) : e.remove() }; setTimeout(t, u) }, l = function (e, t, n) { t = [].concat(t); for (var o = t.length; o--;) { var r = e["on" + t[o]]; if ("function" == typeof r) try { r.call(e, n || e) } catch (a) { f(a) } } }, v = function (e) { return /^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type) ? new Blob([String.fromCharCode(65279), e], { type: e.type }) : e }, p = function (t, f, u) { u || (t = v(t)); var p, w = this, m = t.type, y = m === s, S = function () { l(w, "writestart progress write writeend".split(" ")) }, h = function () { if ((d || y && i) && e.FileReader) { var o = new FileReader; return o.onloadend = function () { var t = d ? o.result : o.result.replace(/^data:[^;]*;/, "data:attachment/file;"), n = e.open(t, "_blank"); n || (e.location.href = t), t = void 0, w.readyState = w.DONE, S() }, o.readAsDataURL(t), void (w.readyState = w.INIT) } if (p || (p = n().createObjectURL(t)), y) e.location.href = p; else { var r = e.open(p, "_blank"); r || (e.location.href = p) } w.readyState = w.DONE, S(), c(p) }; return w.readyState = w.INIT, r ? (p = n().createObjectURL(t), void setTimeout(function () { o.href = p, o.download = f, a(o), S(), c(p), w.readyState = w.DONE })) : void h() }, w = p.prototype, m = function (e, t, n) { return new p(e, t || e.name || "download", n) }; return "undefined" != typeof navigator && navigator.msSaveOrOpenBlob ? function (e, t, n) { return t = t || e.name || "download", n || (e = v(e)), navigator.msSaveOrOpenBlob(e, t) } : (w.abort = function () { }, w.readyState = w.INIT = 0, w.WRITING = 1, w.DONE = 2, w.error = w.onwritestart = w.onprogress = w.onwrite = w.onabort = w.onerror = w.onwriteend = null, m) } }("undefined" != typeof self && self || "undefined" != typeof window && window || this); "undefined" != typeof module && module.exports ? module.exports.saveAs = saveAs : "undefined" != typeof define && null !== define && null !== define.amd && define("FileSaver.js", function () { return saveAs });
        </script>
        <script
            type="text/javascript">var wwdata = { "display": { "nodes": { "0": { "name": "Noodles with soy bean paste", "Northern China or SoutheNetwork of Noodlesrn China": 0 }, "1": { "name": "Hele noodles", "Northern China or Southern China": 0 }, "2": { "name": "Shanxi sliced noodles", "Northern China or Southern China": 0 }, "3": { "name": "Orecchiette", "Northern China or Southern China": 0 }, "4": { "name": "Liangpi", "Northern China or Southern China": 0 }, "5": { "name": "Qishang minced noodles", "Northern China or Southern China": 0 }, "6": { "name": "Minced mutton noodles", "Northern China or Southern China": 0 }, "7": { "name": "Shaanxi biangbiang noddles", "Northern China or Southern China": 0 }, "8": { "name": "Braised noodles", "Northern China or Southern China": 0 }, "9": { "name": "Lanzhou hand-pulled beef noodles", "Northern China or Southern China": 0 }, "10": { "name": "Serofluid noodles", "Northern China or Southern China": 0 }, "11": { "name": "Firecracker noodles", "Northern China or Southern China": 0 }, "12": { "name": "Shuichuan long noodles", "Northern China or Southern China": 0 }, "13": { "name": "Bench-leg noodles", "Northern China or Southern China": 0 }, "14": { "name": "Xinjiang hand-pulled noodles", "Northern China or Southern China": 0 }, "15": { "name": "Tibetan noodle soup", "Northern China or Southern China": 0 }, "16": { "name": "Jiajia noodles", "Northern China or Southern China": 0 }, "17": { "name": "Cold noodle salad with sesame paste", "Northern China or Southern China": 0 }, "18": { "name": "Szechuan cold noodle salad", "Northern China or Southern China": 1 }, "19": { "name": "Penglai seafood noodle soup", "Northern China or Southern China": 0 }, "20": { "name": "Yanji cold noodles\u00e2", "Northern China or Southern China": 0 }, "21": { "name": "Henan stewed noodles", "Northern China or Southern China": 0 }, "22": { "name": "Henan lo mein", "Northern China or Southern China": 0 }, "23": { "name": "Wuhan hot noodles with sesame paste", "Northern China or Southern China": 0 }, "24": { "name": "Xiangyang beef noodles", "Northern China or Southern China": 1 }, "25": { "name": "Changsha rice noodles", "Northern China or Southern China": 1 }, "26": { "name": "Changde rice noodles", "Northern China or Southern China": 1 }, "27": { "name": "Chenzhou fish noodles", "Northern China or Southern China": 1 }, "28": { "name": "Anhui flat noodles", "Northern China or Southern China": 0 }, "29": { "name": "Kunshan aozao noodles\u00e2", "Northern China or Southern China": 1 }, "30": { "name": "Changzhou silver strings noodles", "Northern China or Southern China": 1 }, "31": { "name": "Nanjing fried pork rinds noodles", "Northern China or Southern China": 1 }, "32": { "name": "Huaian fresh water eel noodles", "Northern China or Southern China": 1 }, "33": { "name": "Fengzhen pork noodles", "Northern China or Southern China": 1 }, "34": { "name": "Shanghai noodles with braised pork chop", "Northern China or Southern China": 1 }, "35": { "name": "Hangzhou pian er chuan\u00e2", "Northern China or Southern China": 1 }, "36": { "name": "Yingtan beef rice noodle", "Northern China or Southern China": 1 }, "37": { "name": "Jingdezhen cold rice noodles", "Northern China or Southern China": 1 }, "38": { "name": "Nanchang rice noodles", "Northern China or Southern China": 1 }, "39": { "name": "Shangyao fried rice noodles", "Northern China or Southern China": 1 }, "40": { "name": "Yibing burning noodles", "Northern China or Southern China": 1 }, "41": { "name": "Chongqing street noodles", "Northern China or Southern China": 1 }, "42": { "name": "Crossing-the-bridge rice noodles", "Northern China or Southern China": 1 }, "43": { "name": "Tengchong er si", "Northern China or Southern China": 1 }, "44": { "name": "Samll pot rice noodles", "Northern China or Southern China": 1 }, "45": { "name": "Clay pot rice noodles", "Northern China or Southern China": 1 }, "46": { "name": "Chang wang noodles", "Northern China or Southern China": 1 }, "47": { "name": "Zunyi mutton rice noodles", "Northern China or Southern China": 1 }, "48": { "name": "Noodles with tofu pudding", "Northern China or Southern China": 1 }, "49": { "name": "Guilin rice noodles", "Northern China or Southern China": 1 }, "50": { "name": "Liuzhou luosifen", "Northern China or Southern China": 1 }, "51": { "name": "Nanning laoyou rice noodles", "Northern China or Southern China": 1 }, "52": { "name": "Hainan cold noddles", "Northern China or Southern China": 1 }, "53": { "name": "Beef chow fun", "Northern China or Southern China": 1 }, "54": { "name": "Char kway teow", "Northern China or Southern China": 1 }, "55": { "name": "Chow mein", "Northern China or Southern China": 1 }, "56": { "name": "Shacha noodles", "Northern China or Southern China": 1 }, "57": { "name": "Scallion oil noodles\u00e2", "Northern China or Southern China": 1 }, "58": { "name": "Peanut butter noodles", "Northern China or Southern China": 1 }, "59": { "name": "Wonton noodles", "Northern China or Southern China": 1 }, "60": { "name": "Cart noodles", "Northern China or Southern China": 1 }, "61": { "name": "Shrimp roe lo mien", "Northern China or Southern China": 1 }, "62": { "name": "Tianshui noodles", "Northern China or Southern China": 1 }, "63": { "name": "Lamb rack pulled noodles", "Northern China or Southern China": 0 }, "64": { "name": "Mutton rub noodles", "Northern China or Southern China": 0 }, "65": { "name": "Plain noodles", "Northern China or Southern China": 1 }, "66": { "name": "Zhenjiang pot cover noodles", "Northern China or Southern China": 1 }, "67": { "name": "Stir fry yi mein", "Northern China or Southern China": 1 }, "68": { "name": "Shunde fish noodles", "Northern China or Southern China": 1 }, "69": { "name": "Rice noodles with tofu pudding", "Northern China or Southern China": 1 }, "70": { "name": "Rice noodles with soy bean paste", "Northern China or Southern China": 1 }, "71": { "name": "Hot and sour vermicelli", "Northern China or Southern China": 1 }, "72": { "name": "Intestines vermicelli", "Northern China or Southern China": 1 }, "73": { "name": "Qinghai pulled noodles", "Northern China or Southern China": 0 }, "74": { "name": "Noodles with garlic dipping", "Northern China or Southern China": 0 }, "75": { "name": "Mee sua soup", "Northern China or Southern China": 1 }, "76": { "name": "Taiwanese beef noodle soup", "Northern China or Southern China": 1 }, "77": { "name": "Pot burn noodles", "Northern China or Southern China": 1 }, "78": { "name": "Pot burn noodles", "Northern China or Southern China": 1 }, "79": { "name": "Sesame oil chicken mee sua", "Northern China or Southern China": 1 }, "80": { "name": "Pork knuckle mee sua", "Northern China or Southern China": 1 }, "81": { "name": "Oyster  mee sua", "Northern China or Southern China": 1 } }, "metadata": { "Northern China or Southern China": { "categories": ["Northern", "Southern"] } }, "charge": 30, "gravity": 0.03, "linkLength": 50, "radius": 7, "colorBy": "Northern China or Southern China", "colorPalette": "Dark2", "scaleLinkWidth": true, "showNodeNames": true, "scaleLinkOpacity": true, "sizeBy": "degree" }, "networks": { "": { "layers": [{ "edgeList": [[1, 2], [1, 3], [2, 3], [2, 14], [3, 4], [3, 5], [3, 7], [3, 10], [3, 14], [3, 74], [4, 5], [4, 7], [4, 10], [4, 11], [4, 74], [5, 7], [5, 74], [6, 63], [6, 64], [7, 74], [9, 10], [9, 12], [10, 12], [13, 73], [18, 40], [18, 62], [25, 26], [25, 27], [26, 27], [29, 30], [29, 31], [29, 32], [29, 33], [29, 65], [29, 66], [30, 31], [30, 32], [30, 33], [30, 65], [30, 66], [31, 32], [31, 33], [31, 65], [31, 66], [32, 33], [32, 65], [32, 66], [33, 65], [33, 66], [34, 65], [37, 38], [40, 62], [42, 43], [42, 44], [42, 45], [42, 70], [43, 44], [43, 45], [43, 68], [43, 70], [44, 45], [44, 70], [45, 70], [46, 48], [49, 52], [50, 51], [53, 54], [56, 75], [56, 79], [56, 80], [56, 81], [57, 65], [59, 60], [63, 64], [65, 66], [71, 72], [75, 79], [75, 80], [75, 81], [76, 77], [76, 78], [76, 79], [76, 80], [76, 81], [77, 78], [77, 79], [77, 80], [77, 81], [78, 79], [78, 80], [78, 81], [79, 80], [79, 81], [80, 81]], "nodes": {}, "metadata": null }] } }, 
            "title": "Noodles | Xi Gao" };</script>
       
       
       <script type="text/javascript">/*
    * webweb makes pretty interactive network diagrams in your browser
    *
    * Daniel Larremore + Contributors
    * daniel.larremore@colorado.edu
    * http://github.com/dblarremore/webweb
    * Comments and suggestions always welcome.
    *
    */
            var webweb;
    
            function Webweb(wwdata) {
                this.networkNames = Object.keys(wwdata.networks);
    
                this.scales = {
                    'nodeSize': d3.scaleLinear().range([1, 1]),
                    'colors': {
                        'scalar': d3.scaleLinear().range([1, 1]),
                        'categorical': d3.scaleOrdinal().range([1, 1]),
                    },
                    'links': {
                        'width': d3.scaleLinear().range([1, 1]),
                        'opacity': d3.scaleLinear().range([0.4, 0.9]),
                    },
                };
    
                this.displayDefaults = {
                    'c': 60, // charge
                    'g': 0.1, // gravity
                    'l': 20, // edge length
                    'r': 5, // node radius
                    'linkStrength': 1,
                    'colorPalette': 'Set1',
                    'metadata': {},
                    'nameToMatch': "",
                    'freezeNodeMovement': false,
                    'hideMenu': false,
                    'invertBinaryColors': false,
                    'invertBinarySizes': false,
                    'colorBy': 'none',
                    'sizeBy': 'none',
                    'showLegend': true,
                    'scaleLinkOpacity': false,
                    'networkName': this.networkNames[0],
                    'networkLayer': 0,
                };
    
                this.displaySynonyms = [
                    ['c', 'charge'],
                    ['g', 'gravity'],
                    ['h', 'height'],
                    ['l', 'linkLength'],
                    ['r', 'radius'],
                    ['w', 'width'],
                ];
    
                this.display = this.standardizeDisplayParameterSynonyms(wwdata.display);
                this.standardizeNetworks(wwdata.networks);
    
                this.createNodes();
                this.createSimulation();
    
                this.legendNodes = [];
                this.legendText = [];
            }
            Webweb.prototype.standardizeNetworks = function (networks) {
                this.networks = {};
                for (var networkName in networks) {
                    var network = networks[networkName];
                    this.networks[networkName] = this.standardizeNetwork(network);
                }
            }
            Webweb.prototype.standardizeDisplayParameterSynonyms = function (display) {
                if (display == undefined) {
                    display = {};
                }
    
                for (var i in this.displaySynonyms) {
                    var key1 = this.displaySynonyms[i][0];
                    var key2 = this.displaySynonyms[i][1];
    
                    if (display[key1] == undefined && display[key2] !== undefined) {
                        display[key1] = display[key2];
                    }
    
                    delete display[key2];
                }
    
                for (var key in this.displayDefaults) {
                    if (display[key] == undefined) {
                        display[key] = this.displayDefaults[key];
                    }
                }
    
                return display;
            }
            Webweb.prototype.standardizeNetwork = function (network) {
                if (network.layers == undefined) {
                    network.layers = [
                        {
                            'edgeList': network.edgeList,
                            'nodes': network.nodes,
                            'metadata': network.metadata,
                        }
                    ];
                }
    
                for (var i in network.layers) {
                    network.layers[i] = this.standardizeLayer(network.layers[i]);
                    network.layers[i].nodeIdMap = this.getNodeIdMap(network.layers[i]);
    
                    for (var j in network.layers[i].edgeList) {
                        var edge = network.layers[i].edgeList[j];
                        var source = edge[0];
                        var target = edge[1];
    
                        network.layers[i].edgeList[j][0] = isNaN(source) ? source : +source;
                        network.layers[i].edgeList[j][1] = isNaN(target) ? target : +target;
                    }
                }
    
                return network;
            }
            Webweb.prototype.getNodeIdMap = function (network) {
                var nodeNames = [];
    
                network.edgeList.forEach(function (edge) {
                    nodeNames.push(edge[0]);
                    nodeNames.push(edge[1]);
                });
    
                if (getObjetPropertyCount(this.display.nodes) > 0) {
                    for (var i in this.display.nodes) {
                        var _id = isNaN(i) ? i : +i;
                        nodeNames.push(_id);
                    }
                }
    
                if (getObjetPropertyCount(network.nodes) > 0) {
                    for (var i in network.nodes) {
                        var _id = isNaN(i) ? i : +i;
                        nodeNames.push(_id);
                    }
                }
    
                if (allInts(nodeNames)) {
                    nodeNames.sort(function (a, b) { return a - b });
                }
    
    
                var unusedId = 0;
                var nodeIdMap = {};
                nodeNames.forEach(function (name) {
                    if (nodeIdMap[name] == undefined) {
                        nodeIdMap[name] = unusedId;
                        nodeIdMap[+name] = unusedId;
                        unusedId += 1;
                    }
                });
    
                var unusedName = 0;
                for (var key in nodeIdMap) {
                    key = +key;
                    if (isInt(key) && key >= unusedName) {
                        unusedName = key + 1;
                    }
                }
    
                var count = 0;
                for (var i in nodeIdMap) {
                    count += 1;
                }
    
                var displayMetadataValuesCount = metadataValuesCount(this.display.metadata);
    
                if (displayMetadataValuesCount > unusedId) {
                    while (displayMetadataValuesCount > unusedId) {
                        nodeIdMap[unusedName] = unusedId;
                        unusedName += 1;
                        unusedId += 1;
                    }
                }
    
                var networkMetadataValuesCount = metadataValuesCount(network.metadata);
    
                if (networkMetadataValuesCount > unusedId) {
                    while (networkMetadataValuesCount > unusedId) {
                        nodeIdMap[unusedName] = unusedId;
                        unusedName += 1;
                        unusedId += 1;
                    }
                }
    
                return nodeIdMap;
            }
            Webweb.prototype.getNodeCount = function (network) {
                var nodeIdMap = this.getNodeIdMap(network);
    
                var count = 0;
                for (var node in nodeIdMap) {
                    var nodeId = nodeIdMap[node];
                    if (nodeId > count) {
                        count = nodeId
                    }
                }
                // those were indexes; add one
                count += 1;
                return count;
            }
            Webweb.prototype.standardizeLayer = function (layer) {
                if (this.display.metadata == undefined) {
                    this.display.metadata = {};
                }
                if (layer.metadata !== undefined) {
                    for (var metadatum in layer.metadata) {
                        var layerMetadatum = layer.metadata[metadatum];
    
                        var displayMetadatum = {};
                        if (this.display.metadata[metadatum] !== undefined) {
                            displayMetadatum = this.display.metadata[metadatum];
                        }
    
                        if (layerMetadatum.categories !== undefined) {
                            displayMetadatum.categories = layerMetadatum.categories;
                        }
    
                        if (layerMetadatum.type !== undefined) {
                            displayMetadatum.type = layerMetadatum.type;
                        }
    
                        this.display.metadata[metadatum] = displayMetadatum;
                    }
                }
    
                return layer;
            }
            ////////////////////////////////////////////////////////////////////////////////
            // Webweb:
            // nodes
            ////////////////////////////////////////////////////////////////////////////////
            ////////////////////////////////////////////////////////////////////////////////
            // initialize the nodes (attempting to be smart about the number of them)
            ////////////////////////////////////////////////////////////////////////////////
            Webweb.prototype.createNodes = function () {
                // iterate through the networks and get their node counts
                this.maxNodeCount = 0;
                for (var i in this.networks) {
                    var network = this.networks[i];
                    for (var i in network.layers) {
                        var nodeCount = this.getNodeCount(network.layers[i]);
    
                        if (nodeCount > this.maxNodeCount) {
                            this.maxNodeCount = nodeCount;
                        }
                    }
                }
    
                this.nodes = [];
                for (var i = 0; i < this.maxNodeCount; i++) {
                    this.nodes.push(new Node(i));
                }
    
                this.nodesPersistence = [];
            }
            ////////////////////////////////////////////////////////////////////////////////
            // 
            // Node
            // 
            ////////////////////////////////////////////////////////////////////////////////
            function Node(idx) {
                this.idx = idx;
            }
    
            Node.prototype.radius = function () {
                if (this.fixedRadius) {
                    return this.fixedRadius;
                }
    
                var radius = this.__scaledSize * webweb.display.r;
                if (this.matchesString() || this.containsMouse(radius)) {
                    radius *= 1.3;
                }
    
                return radius;
            }
            Node.prototype.outline = function () {
                if (this.matchesString() || this.containsMouse()) {
                    return "black";
                }
                else {
                    return d3.rgb(255, 255, 255);
                }
            }
            Node.prototype.isMetadataKey = function (key) {
                var nonMetadataKeys = [
                    'degree',
                    'strength',
                    'fx',
                    'fy',
                    'idx',
                    'index',
                    'vx',
                    'vy',
                    'x',
                    'y',
                ];
    
                if (nonMetadataKeys.indexOf(key) < 0) {
                    var attribute = this[key];
    
                    if (attribute && {}.toString.call(attribute) !== '[object Function]') {
                        return true;
                    }
                }
    
                return false;
            }
            Node.prototype.draw = function (ctx) {
                var radius = this.radius();
                ctx.beginPath();
                ctx.arc(this.x, this.y, radius, 0, Math.PI * 2, false)
                ctx.strokeStyle = this.outline();
                ctx.stroke();
                ctx.fillStyle = d3.rgb(this.__scaledColor);
                ctx.fill();
    
                this.pushNodeText();
            }
            Node.prototype.pushNodeText = function () {
                var radius = this.radius();
                if (!this.nonInteractive) {
                    if (this.matchesString() || webweb.display.showNodeNames || this.containsMouse(radius)) {
                        if (webweb.simulation.alpha() < .05 || webweb.display.freezeNodeMovement) {
                            var text = this.name || this.idx;
                            var textX = this.x + 1.1 * radius;
                            var textY = this.y - 1.1 * radius;
                            var font = "12px";
                            webweb.nodeText.push(new Text(text, textX, textY, font));
                        }
                    }
                }
            }
            Node.prototype.drawSVG = function () {
                var circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttributeNS(null, 'cx', this.x);
                circle.setAttributeNS(null, 'cy', this.y);
                circle.setAttributeNS(null, 'r', this.radius());
                circle.setAttributeNS(null, 'style', 'fill: ' + d3.rgb(this.__scaledColor) + '; stroke: ' + this.outline() + ';');
    
                this.pushNodeText();
                return circle;
            }
            Node.prototype.containsMouse = function (radius) {
                if (webweb.canvas.mouseState == undefined) {
                    return false;
                }
    
                // recursion...
                if (radius == undefined) {
                    radius = 1.3 * this.radius();
                }
    
                if (
                    this.x + radius >= webweb.canvas.mouseState.x &&
                    this.x - radius <= webweb.canvas.mouseState.x &&
                    this.y + radius >= webweb.canvas.mouseState.y &&
                    this.y - radius <= webweb.canvas.mouseState.y
                ) {
                    return true;
                }
    
                return false;
            }
            Node.prototype.matchesString = function () {
                var matchString = webweb.display.nameToMatch;
                if (matchString !== undefined && matchString.length > 0) {
                    if (this.name !== undefined && this.name.indexOf(matchString) >= 0) {
                        return true;
                    }
                }
    
                return false;
            }
            ////////////////////////////////////////////////////////////////////////////////
            // 
            // Text
            // 
            ////////////////////////////////////////////////////////////////////////////////
            function Text(value, x, y, font) {
                this.value = value;
                this.x = x;
                this.y = y;
                this.font = font;
            }
    
            Text.prototype.draw = function (ctx) {
                ctx.save();
                ctx.fillStyle = "black";
                ctx.font = this.font;
                ctx.fillText(this.value, this.x, this.y);
                ctx.restore();
            }
            Text.prototype.drawSVG = function () {
                var text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.textContent = this.value;
                text.setAttributeNS(null, 'x', this.x);
                text.setAttributeNS(null, 'y', this.y);
                text.setAttributeNS(null, 'style', 'fill: black; font-size: ' + this.font + ';');
                return text;
            }
            ////////////////////////////////////////////////////////////////////////////////
            // 
            // Link
            // 
            ////////////////////////////////////////////////////////////////////////////////
            function Link(source, target, weight) {
                this.source = source;
                this.target = target;
                this.w = weight;
                this.strokeStyle = d3.rgb(150, 150, 150)
            }
            Link.prototype.width = function () {
                return this.w == 0 ? 0 : webweb.scales.links.width(this.w);
            }
            Link.prototype.opacity = function () {
                return webweb.scales.links.opacity(this.w);
            }
            Link.prototype.draw = function (ctx) {
                ctx.save();
                ctx.globalAlpha = this.opacity();
                ctx.beginPath();
                ctx.moveTo(this.source.x, this.source.y);
                ctx.lineTo(this.target.x, this.target.y);
                ctx.lineWidth = this.width();
                ctx.strokeStyle = this.strokeStyle;
                ctx.stroke();
                ctx.restore();
            }
            Link.prototype.drawSVG = function () {
                var link = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                link.setAttributeNS(null, 'x1', this.target.x);
                link.setAttributeNS(null, 'y1', this.target.y);
                link.setAttributeNS(null, 'x2', this.source.x);
                link.setAttributeNS(null, 'y2', this.source.y);
                link.setAttributeNS(null, 'style', 'stroke: ' + this.strokeStyle + '; stroke-opacity: ' + this.opacity() + ';' + 'stroke-width: ' + this.width() + ';');
    
                return link;
            }
            ////////////////////////////////////////////////////////////////////////////////
            // adds/removes nodes from the visualization
            ////////////////////////////////////////////////////////////////////////////////
            Webweb.prototype.setVisibleNodes = function () {
                var count = this.getNodeCount(webweb.displayedNetworkData());
    
                if (!count) {
                    count = this.maxNodeCount;
                }
    
                if (count < this.nodes.length) {
                    while (count != this.nodes.length) {
                        var node = this.nodes.pop();
                        this.nodesPersistence.push(node);
                    }
                }
                else if (count > this.nodes.length) {
                    while (count != this.nodes.length) {
                        var node = this.nodesPersistence.pop();
                        this.nodes.push(node);
                    }
                }
            }
            Webweb.prototype.resetNodeMetadata = function () {
                // reset node data
                for (var i in this.nodes) {
                    for (var key in this.nodes[i]) {
                        if (this.nodes[i].isMetadataKey(key)) {
                            delete this.nodes[i][key];
                        }
                        else if (key == 'degree' || key == 'strength') {
                            // reset the degree and strength (strength not yet supported)
                            this.nodes[i][key] = 0;
                        }
                    }
                }
            }
            Webweb.prototype.standardizeSourceMetadata = function (source) {
                var nodeIdMap = this.displayedNetworkData().nodeIdMap;
    
                // add the vectorized node metadata to the nodes
                for (var metadatum in source.metadata) {
                    var values = source.metadata[metadatum].values;
                    for (var i in values) {
                        this.nodes[i][metadatum] = values[i];
                    }
                }
    
                if (getObjetPropertyCount(source.nodes) == 0) {
                    return;
                }
    
                for (var i in source.nodes) {
                    for (var metadatum in source.nodes[i]) {
                        this.nodes[nodeIdMap[i]][metadatum] = source.nodes[i][metadatum];
                    }
                }
            }
            ////////////////////////////////////////////////////////////////////////////////
            // loads the metadata up from the places they could come from:
            // 1. the defaults (none, degree)
            // 2. the display parameters
            // 3. the network itself
            //
            // Priority is given to the network's metadata, then display, then defaults
            ////////////////////////////////////////////////////////////////////////////////
            Webweb.prototype.setNodeMetadata = function () {
                this.setVisibleNodes();
                this.resetNodeMetadata();
    
                var networkData = this.displayedNetworkData();
                var nodeIdMap = networkData.nodeIdMap;
    
                this.standardizeSourceMetadata(this.display);
                this.standardizeSourceMetadata(networkData);
    
                var nodeNameMap = {};
                for (var key in nodeIdMap) {
                    nodeNameMap[nodeIdMap[key]] = key;
                }
    
                // now we need to define the set of metadata
                for (var i in this.nodes) {
                    var node = this.nodes[i];
                    for (var key in node) {
                        if (node.isMetadataKey(key)) {
                            if (this.display.metadata !== undefined && this.display.metadata[key] !== undefined) {
                                var metadatumInfo = this.display.metadata[key];
    
                                var value = this.nodes[i][key];
    
                                // if we have categories, change the node values here
                                if (metadatumInfo.categories !== undefined) {
                                    if (isInt(value)) {
                                        var nodeCategoryNumber = this.nodes[i][key];
                                        this.nodes[i][key] = metadatumInfo.categories[nodeCategoryNumber];
                                    }
                                }
                                else if (metadatumInfo.type !== undefined && metadatumInfo.type == 'binary') {
                                    this.nodes[i][key] = value ? true : false;
                                }
                            }
                        }
                    }
    
                    // if we don't already have node names, use the mapping to assign them
                    if (this.nodes[i]['name'] == undefined && nodeNameMap !== undefined) {
                        this.nodes[i]['name'] = nodeNameMap[this.nodes[i].idx];
                    }
                }
    
                this.allMetadata = {
                    'none': {
                        'type': 'none',
                    },
                    'degree': {
                        'type': 'degree',
                    },
                    'strength': {
                        'type': 'degree',
                    },
                };
    
                // identify the set of metadata keys
                this.nodes.forEach(function (node) {
                    for (var key in node) {
                        if (node.isMetadataKey(key)) {
                            if (this.allMetadata[key] == undefined) {
                                var networkMetadata = networkData.metadata;
                                if (networkMetadata !== undefined && networkMetadata !== null && networkMetadata[key] !== undefined) {
                                    this.allMetadata[key] = networkMetadata[key];
                                }
                                else if (this.display.metadata[key] !== undefined) {
                                    this.allMetadata[key] = this.display.metadata[key];
                                }
                                else {
                                    this.allMetadata[key] = {};
                                }
                            }
                        }
                    }
                }, this);
    
                for (metadatum in this.allMetadata) {
                    if (this.allMetadata[metadatum].type == undefined) {
                        this.allMetadata[metadatum].type = this.getMetadatumType(metadatum);
                    }
    
                    if (this.allMetadata[metadatum].type == "categorical") {
                        this.setCategoricalMetadataInfo(metadatum);
                    }
                }
    
                // these below if statements are only here because of poor design (says
                // hunter, the designer of this bit)
                // really, computeSizes and computeColors should already have this
                // information.
                if (this.display.colorBy !== undefined && this.display.colorBy !== 'none') {
                    if (this.allMetadata !== undefined && this.allMetadata[this.display.colorBy] == undefined) {
                        this.display.colorBy = 'none';
                    }
                }
                if (this.display.sizeBy !== undefined && this.display.sizeBy !== 'none') {
                    if (this.allMetadata !== undefined && this.allMetadata[this.display.sizeBy] == undefined) {
                        this.display.sizeBy = 'none';
                    }
                }
            }
            ////////////////////////////////////////////////////////////////////////////////
            // tries to figure out the metadatum type of a given metadatum.
            ////////////////////////////////////////////////////////////////////////////////
            Webweb.prototype.getMetadatumType = function (metadatum) {
                if (metadatum == 'none') {
                    return;
                }
    
                var q = d3.set(getRawNodeValues(metadatum)).values().sort();
    
                // check if this is a binary relation
                if (q.length == 2 && q[0] == 'false' && q[1] == 'true') {
                    return 'binary';
                }
                else if (q.length == 1 && (q[0] == 'false' || q[0] == 'true')) {
                    return 'binary';
                }
                else if (q.some(isNaN)) {
                    return 'categorical';
                }
    
                return 'scalar';
            }
            Webweb.prototype.setCategoricalMetadataInfo = function (metadatum) {
                var metadata = this.allMetadata[metadatum];
    
                if (metadata.categories == undefined) {
                    var rawValues = getRawNodeValues(metadatum);
                    metadata.categories = d3.set(rawValues).values().sort();
                }
    
                if (metadata.categories.length >= 9) {
                    metadata.type = 'scalarCategorical';
                }
    
                this.allMetadata[metadatum] = metadata;
            }
            ////////////////////////////////////////////////////////////////////////////////
            // initialize links/edges
            //
            // - scale link width/opacity
            // - calculate node weights/degrees
            ////////////////////////////////////////////////////////////////////////////////
            Webweb.prototype.createLinks = function () {
                var networkData = this.displayedNetworkData();
                var nodeIdMap = networkData.nodeIdMap;
    
                var linkMatrix = {};
    
                // reset the node degrees
                for (var i in this.nodes) {
                    webweb.nodes[i].degree = 0;
                    webweb.nodes[i].strength = 0;
    
                    linkMatrix[i] = {};
                    for (var j in this.nodes) {
                        linkMatrix[i][j] = 0;
                    }
                }
    
                // push all the links to the list: links
                for (var i in networkData.edgeList) {
                    var edge = networkData.edgeList[i];
                    var source = nodeIdMap[edge[0]];
                    var target = nodeIdMap[edge[1]];
    
                    // if there's no edge weight, default it to 1
                    var weight = edge.length == 3 ? parseFloat(edge[2]) : 1;
    
                    if (source <= target) {
                        linkMatrix[source][target] += weight;
                    }
                    else {
                        linkMatrix[target][source] += weight;
                    }
    
                    this.nodes[source].degree += 1;
                    this.nodes[target].degree += 1;
                    this.nodes[source].strength += weight;
                    this.nodes[target].strength += weight;
                }
    
                var edgeWeights = [];
                this.links = [];
                for (var source in linkMatrix) {
                    for (var target in linkMatrix[source]) {
                        if (linkMatrix[source][target]) {
                            this.links.push(new Link(
                                source,
                                target,
                                linkMatrix[source][target],
                            ));
                        }
                        edgeWeights.push(linkMatrix[source][target]);
                    }
                }
    
                var networkIsUnweighted = true;
                this.nodes.forEach(function (node) {
                    if (node.strength !== node.degree) {
                        networkIsUnweighted = false;
                    }
                });
    
                if (networkIsUnweighted) {
                    delete this.allMetadata.strength;
                }
    
                this.scales.links.width.domain(d3.extent(edgeWeights));
                this.scales.links.opacity.domain(d3.extent(edgeWeights));
            }
            ////////////////////////////////////////////////////////////////////////////////
            // Webweb:
            //
            // UTIL
            ////////////////////////////////////////////////////////////////////////////////
            Webweb.prototype.displayedNetworkData = function () {
                return this.networks[this.display.networkName].layers[this.display.networkLayer];
            }
            Webweb.prototype.getSizeByType = function () {
                return this.allMetadata[this.display.sizeBy].type;
            }
            Webweb.prototype.getColorByType = function () {
                return this.allMetadata[this.display.colorBy].type;
            }
            ////////////////////////////////////////////////////////////////////////////////
            // Webweb:
            // simulation
            //////////////////////////////////////////////////////////////////////////////// 
            Webweb.prototype.tick = function () {
                webweb.canvas.redraw.call(webweb.canvas);
            }
            Webweb.prototype.createSimulation = function () {
                this.simulation = d3.forceSimulation(this.nodes)
                    .on('tick', this.tick);
    
                this.simulation.alphaDecay = 0.001
    
                this.forces = {
                    "center": function () {
                        return d3.forceCenter(this.display.w / 2, this.display.h / 2);
                    },
                    "charge": function () {
                        return d3.forceManyBody().strength(-this.display.c);
                    },
                    "gravity-x": function () {
                        return d3.forceX(this.display.w / 2).strength(this.display.g);
                    },
                    "gravity-y": function () {
                        return d3.forceY(webweb.display.h / 2).strength(webweb.display.g);
                    },
                    "link": function () {
                        return d3.forceLink()
                            .links(this.links)
                            .distance(this.display.l)
                            .strength(this.display.linkStrength);
                    },
                }
            }
            Webweb.prototype.updateSimulation = function (force) {
                var forcesToUpdate = [];
                if (force && this.forces[force] !== undefined) {
                    forcesToUpdate.push(force)
                }
                else {
                    for (var force in this.forces) {
                        forcesToUpdate.push(force);
                    }
                }
    
                for (var i in forcesToUpdate) {
                    var forceToUpdate = forcesToUpdate[i];
                    var updatedForce = this.forces[forceToUpdate].call(this);
                    this.simulation.force(forceToUpdate, updatedForce);
                }
                this.simulation.alpha(1).restart();
            }
            ////////////////////////////////////////////////////////////////////////////////
            // initializeWebweb
            //
            // run once on startup
            //
            // - loads webweb data
            // - standardizes its representation
            // - sets up the scales
            // - initializes the webweb html
            // - computes and draws nodes
            ////////////////////////////////////////////////////////////////////////////////
            function initializeWebweb() {
                webweb = new Webweb(wwdata);
    
                initializeHTML();
                displayNetwork();
            }
            function initializeHTML() {
                var container;
    
                if (webweb.display.attachWebwebToElementWithId == undefined) {
                    var container = document.createElement('div');
                    // var container = document.getElementById('grab_this');

                    container.setAttribute('id', 'webweb-center');
    
                    // document.getElementsByTagName("body")[0].appendChild(container);
                    document.getElementById("for_webweb").appendChild(container);
    


                    if (wwdata.title !== undefined) {
                        document.title = wwdata.title;
                    }
                }
                else {
                    container = document.getElementById(webweb.display.attachWebwebToElementWithId);
                }
    
                writeMenus(container);
                writeVisualization(container);
            }
            function writeVisualization(container) {
                var visualizationContainer = document.createElement("div");
                visualizationContainer.setAttribute('id', 'webweb-visualization-container');
    
                container.appendChild(visualizationContainer);
    
                if (webweb.display.w == undefined) {
                    var heuristic = container.clientWidth - 3 * 20;
    
                    if (heuristic <= 0) {
                        heuristic = 1000;
                    }
                    webweb.display.w = Math.min.apply(null, [heuristic, 1000]);
                }
    
                if (webweb.display.h == undefined) {
                    webweb.display.h = Math.min.apply(null, [webweb.display.w, 600]);
                }
    
                webweb.canvas = new CanvasState(webweb);
                document.getElementById('webweb-visualization-container').appendChild(webweb.canvas.canvas);
            }
    
            ////////////////////////////////////////////////////////////////////////////////
            // - changes the number of visible nodes
            // - adds metadata to nodes
            // - computes links
            // - draws links
            // - uses the force (luke)
            ////////////////////////////////////////////////////////////////////////////////
            function displayNetwork() {
                webweb.setNodeMetadata();
                webweb.createLinks();
                webweb.updateSimulation();
    
                // update the menus with these new metadata
                updateSizeMenu();
                updateColorMenu();
    
                toggleFreezeNodes(webweb.display.freezeNodeMovement);
                toggleShowNodeNames(webweb.display.showNodeNames);
                toggleInvertBinaryColors(webweb.display.invertBinaryColors);
                toggleInvertBinarySizes(webweb.display.invertBinarySizes);
                toggleLinkWidthScaling(webweb.display.scaleLinkWidth);
                toggleLinkOpacityScaling(webweb.display.scaleLinkOpacity);
    
                // change the display of the layers widget
                setNetworkLayerMenuVisibility();
    
                // if we've frozen node movement manually tick so new edges are evaluated.
                if (webweb.display.freezeNodeMovement) {
                    webweb.canvas.redraw();
                }
    
                computeLegend();
            }
            ////////////////////////////////////////////////////////////////////////////////
            // creates a map from observed nodes (nodes in the edge list, display.nodes, and
            // the current layer's nodes) to an internal "id"
            ////////////////////////////////////////////////////////////////////////////////
            function metadataValuesCount(metadata) {
                var maxValuesCount = 0;
                if (metadata !== undefined) {
                    for (var metadatum in metadata) {
                        var values = metadata[metadatum].values;
                        if (values !== undefined) {
                            var valuesCount = values.length;
                            if (valuesCount > maxValuesCount) {
                                maxValuesCount = valuesCount;
                            }
                        }
                    }
                }
                return maxValuesCount;
            }
            ////////////////////////////////////////////////////////////////////////////////
            // Compute the radius multipliers of the nodes, given the data and chosen parameters
            // 
            // the 'sizeBy' display parameter determines how we will scale this.
            // For example, if sizeBy is None, then the multiplier is 1 (the identity)
            // Otherwise, the multiplier can be something else!
            ////////////////////////////////////////////////////////////////////////////////
            function computeSizes() {
                var rawValues = [];
                var scaledValues = [];
    
                var sizeBy = webweb.display.sizeBy;
    
                // set all sizes to 1 if there's no scaling 
                if (sizeBy == "none") {
                    for (var i in webweb.nodes) {
                        scaledValues[i] = 1;
                        rawValues[i] = 1;
                    }
                }
                else {
                    var type = webweb.getSizeByType();
                    rawValues = getRawNodeValues(sizeBy, type, 'size');
    
                    // if we're sizing by degree (or strength), square root the value
                    rawValues.forEach(function (val) {
                        var scaled = type == 'degree' ? Math.sqrt(val) : val;
                        scaledValues.push(scaled);
                    });
    
                    // scale between true and false even if we only have one of
                    // the two values
                    var extent = type == 'binary' ? [true, false] : scaledValues;
                    var range = d3.set(extent).values().length > 1 ? [0.5, 1.5] : [1, 1];
    
                    webweb.scales.nodeSize.domain(d3.extent(extent)).range(range);
    
                    for (var i in scaledValues) {
                        scaledValues[i] = webweb.scales.nodeSize(scaledValues[i]);
                    }
                }
    
                for (var i in webweb.nodes) {
                    webweb.nodes[i]['__scaledSize'] = scaledValues[i];
                    webweb.nodes[i]['__rawSize'] = rawValues[i];
                }
            }
            ////////////////////////////////////////////////////////////////////////////////
            // computes the colors for the nodes based on the preferences of the user chosen
            // in the dropdown menus.
            ////////////////////////////////////////////////////////////////////////////////
            function computeColors() {
                var rawValues = [];
                var scaledValues = [];
    
                // no colors
                if (webweb.display.colorBy == "none") {
                    for (var i in webweb.nodes) {
                        rawValues[i] = d3.rgb(100, 100, 100);
                        scaledValues[i] = d3.rgb(100, 100, 100);
                    }
                }
                else {
                    var type = webweb.getColorByType();
                    var rawValues = getRawNodeValues(webweb.display.colorBy, type, 'color');
    
                    if (type == 'binary' || type == 'categorical') {
                        var categoryValues = [];
    
                        if (type == 'binary') {
                            categoryValues = getBinaryValues('color');
                        }
                        else {
                            categoryValues = d3.set(rawValues).values().sort();
                        }
    
                        var categoryValuesCount = categoryValues.length;
    
                        // make sure there's enough categories even if there aren't
                        if (categoryValuesCount == 1) {
                            categoryValuesCount += 1;
                        }
    
                        // if there are fewer than 9 categories, use the colorbrewer
                        // TODO:
                        // actually check how many colors there are in the user's selected
                        // colorbrewer
                        // update the list for this...
                        webweb.scales.colors.categorical.domain(categoryValues)
                            .range(colorbrewer[webweb.display.colorPalette][categoryValuesCount]);
                    }
                    else if (type == 'scalarCategorical') {
                        var categoryValues = d3.set(rawValues).values().sort();
                        var unusedNumber = 1;
                        var categoriesMap = {};
                        for (var i in categoryValues) {
                            categoriesMap[categoryValues[i]] = i;
                            unusedNumber += 1;
                        }
    
                        for (var i in rawValues) {
                            rawValues[i] = categoriesMap[rawValues[i]];
                        }
                    }
    
                    if (type != 'categorical') {
                        webweb.scales.colors.scalar.domain(d3.extent(rawValues)).range([0, 1]);
                    }
                }
    
                for (var i in webweb.nodes) {
                    scaledValues[i] = colorWheel(rawValues[i]);
                    webweb.nodes[i]['__scaledColor'] = scaledValues[i];
                    webweb.nodes[i]['__rawColor'] = rawValues[i];
                }
            }
            ////////////////////////////////////////////////////////////////////////////////
            // returns raw values for:
            // - a metadatumName
            // - a metadatumType
            // - a displayType (color/size)
            ////////////////////////////////////////////////////////////////////////////////
            function getRawNodeValues(metadatumName, metadatumType, displayType) {
                var rawValues = [];
                for (var i in webweb.nodes) {
                    var val = webweb.nodes[i][metadatumName];
    
                    if (metadatumType == 'binary') {
                        val = getBinaryValue(val, displayType);
                    }
    
                    rawValues[i] = val;
                }
    
                return rawValues;
            }
            // ColorWheel is a function that takes a node metadatum, like a category or scalar
            // and just gets the damn color. But it has to take into account what the 
            // current colorType is. Basically, this is trying to apply our prefs to colors
            function colorWheel(x) {
                var type = webweb.getColorByType();
    
                if (type == "categorical") {
                    return webweb.scales.colors.categorical(x);
                }
                else if (type == 'binary') {
                    return webweb.scales.colors.categorical(getBinaryValue(x, 'color'));
                }
                else {
                    return d3.hsl(210 * (1 - webweb.scales.colors.scalar(x)), 0.7, 0.5);
                }
            }
            ////////////////////////////////////////////////////////////////////////////////
            //
            //
            // Menu Interaction
            //
            //
            ////////////////////////////////////////////////////////////////////////////////
            function changeNetwork(networkName) {
                var networkSelect = document.getElementById('networkSelect-widget');
                networkSelect.value = networkName;
    
                webweb.display.networkName = networkName;
                changeLayer(0);
            }
            function changeSizes(sizeBy) {
                webweb.display.sizeBy = sizeBy;
    
                computeLegend();
                webweb.canvas.redraw();
    
                var showInvertWidget = webweb.getSizeByType() == 'binary' ? true : false;
                setInvertBinaryWidgetVisibility(showInvertWidget, 'size');
            }
            function changeColors(colorBy) {
                webweb.display.colorBy = colorBy;
                computeLegend();
                webweb.canvas.redraw();
                var showColorPaletteWidget = webweb.getColorByType() == 'categorical' ? true : false;
                var showInvertWidget = false;
    
                if (webweb.getColorByType() == 'binary') {
                    showColorPaletteWidget = true;
                    showInvertWidget = true;
                }
                setColorPaletteMenuVisibility(showColorPaletteWidget);
                setInvertBinaryWidgetVisibility(showInvertWidget, 'color');
            }
            function setColorPalette(colorPalette) {
                webweb.display.colorPalette = colorPalette;
                computeLegend();
                webweb.canvas.redraw();
            }
            function changeCharge(c) {
                if (c >= 0) {
                    webweb.display.c = c;
                    webweb.updateSimulation("charge");
                }
                else {
                    alert("Repulsion must be nonnegative.");
                }
            }
            function changeR(r) {
                webweb.display.r = r;
                computeLegend();
                webweb.canvas.redraw();
            }
            function changeDistance(l) {
                if (l >= 0) {
                    webweb.display.l = l;
                    webweb.updateSimulation("link");
                    webweb.canvas.redraw();
                }
                else {
                    alert("Distance must be nonnegative.");
                }
            }
            function changeLinkStrength(linkStrength) {
                if (linkStrength >= 0) {
                    webweb.display.linkStrength = linkStrength;
                    webweb.updateSimulation("link");
                }
                else {
                    alert("Distance must be nonnegative.");
                }
            }
            function changeGravity(g) {
                if (parseFloat(g) >= 0) {
                    webweb.display.g = parseFloat(g);
                    webweb.updateSimulation("gravity-x");
                    webweb.updateSimulation("gravity-y");
                }
                else {
                    alert("Gravity must be nonnegative.");
                }
            }
            function toggleFreezeNodes(isFrozen) {
                webweb.display.freezeNodeMovement = isFrozen;
                if (isFrozen) {
                    webweb.simulation.stop();
                    for (var i = 0; i < webweb.simulation.nodes().length; i++) {
                        webweb.simulation.nodes()[i].fx = webweb.simulation.nodes()[i].x;
                        webweb.simulation.nodes()[i].fy = webweb.simulation.nodes()[i].y;
                    }
                }
                else {
                    for (var i = 0; i < webweb.simulation.nodes().length; i++) {
                        webweb.simulation.nodes()[i].fx = undefined;
                        webweb.simulation.nodes()[i].fy = undefined;
                    }
                    webweb.updateSimulation("__");
                }
    
                var freezeNodesToggle = document.getElementById('freezeNodes-widget');
                freezeNodesToggle.checked = webweb.display.freezeNodeMovement ? true : false;
                webweb.canvas.redraw();
            }
            function toggleShowNodeNames(show) {
                webweb.display.showNodeNames = show;
                var showNodeNamesWidget = document.getElementById('showNodeNames-widget');
                showNodeNamesWidget.checked = webweb.display.showNodeNames;
                webweb.canvas.redraw();
            }
            function toggleInvertBinaryColors(setting) {
                var widget = document.getElementById('invertBinaryColors-widget');
                widget.checked = setting;
                webweb.display.invertBinaryColors = setting;
    
                computeLegend();
                webweb.canvas.redraw();
            }
            function toggleInvertBinarySizes(setting) {
                var widget = document.getElementById('invertBinarySizes-widget');
                widget.checked = setting;
                webweb.display.invertBinarySizes = setting;
    
                computeLegend();
                webweb.canvas.redraw();
            }
            function getBinaryValue(value, type) {
                var attribute = getBinaryInversionAttributeForType(type);
    
                if (webweb.display[attribute]) {
                    return value ? false : true;
                }
                else {
                    return value;
                }
            }
            function getBinaryValues(type) {
                return [getBinaryValue(false, type), getBinaryValue(true, type)];
            }
            function toggleLinkWidthScaling(checked) {
                var range = checked ? [0.5, 2] : [1, 1];
                webweb.display.scaleLinkWidth = checked;
                webweb.scales.links.width.range(range);
                webweb.canvas.redraw();
            }
            function toggleLinkOpacityScaling(checked) {
                var range = checked ? [0.3, 0.9] : [1, 1];
                webweb.display.scaleLinkOpacity = checked;
                webweb.scales.links.opacity.range(range);
                webweb.canvas.redraw();
            }
            function matchNodesNamed(x) {
                webweb.display.nameToMatch = x;
                webweb.canvas.redraw();
            }
            ////////////////////////////////////////////////////////////////////////////////
            //
            //
            //
            //
            // Legends
            //
            //
            //
            //
            ////////////////////////////////////////////////////////////////////////////////
    
            ////////////////////////////////////////////////////////////////////////////////
            // draw legend(s) for size and color
            // 
            // If size and color are tied to the same attribute, make one legend
            // Otherwise, keep em separate
            //
            // prefer integer boundaries in our legends... but only if the values that are
            // getting passed in are integers... etc. (etc... etc...)
            //
            // steps through what we think of as standard human preference.
            ////////////////////////////////////////////////////////////////////////////////
            function computeLegend() {
                computeColors();
                computeSizes();
                webweb.legendNodes = [];
                webweb.legendText = [];
    
                var sizeBy = webweb.display.sizeBy;
                var sizeType = webweb.getSizeByType();
                var colorBy = webweb.display.colorBy;
                var colorType = webweb.getColorByType();
    
                if (sizeType == "none" && colorType == "none") {
                    return;
                };
    
                var sizeLegend = new Legend(sizeBy, 'size', sizeType, getRawNodeValues('__rawSize'));
                var colorLegend = new Legend(colorBy, 'color', colorType, getRawNodeValues('__rawColor'));
    
                var R = 0;
    
                if (sizeLegend.values.length > 0) {
                    R = webweb.display.r * d3.max(sizeLegend.values);;
                }
    
                // if we have a color legend, use it for the size menu (if it's there)
                var fillFunction = function (i) {
                    return d3.rgb(100, 100, 100);
                };
    
                if (sizeBy == colorBy) {
                    fillFunction = function (i) {
                        return colorWheel(colorLegend.values[i]);
                    }
                }
    
                var datatypeTextPushdown = 15;
    
                var textPushRight = 2 * (Math.max(R, 5) + 5);
                var nodePushRight = 5 + Math.max(R, 5);
                var pushdown = function (i) { return 0 };
    
                if (sizeBy != "none") {
                    pushdown = function (i) {
                        if (i !== undefined) {
                            return 5 + R + 2.3 * R * i + datatypeTextPushdown;
                        }
                        return datatypeTextPushdown;
                    };
    
                    sizeLegend.drawLegendLabel(pushdown);
                    sizeLegend.drawLegendText(pushdown, textPushRight);
                    sizeLegend.drawLegendValues(
                        pushdown,
                        nodePushRight,
                        function (d) { return webweb.display.r * d },
                        fillFunction,
                    );
                }
    
                // if we've drawn the size legend and the color legend shows the same value,
                // return
                if (sizeBy == colorBy) {
                    return;
                }
    
                if (colorType != "none") {
                    var initialPushdown = datatypeTextPushdown;
    
                    if (webweb.display.sizeBy != "none") {
                        initialPushdown += pushdown(sizeLegend.values.length);
                        pushdown = function (i) {
                            if (i !== undefined) {
                                return 2.3 * Math.max(R, 7.5) * i + initialPushdown + datatypeTextPushdown;
                            }
                            return initialPushdown;
                        }
                    }
                    else {
                        pushdown = function (i) {
                            if (i !== undefined) {
                                return 2.3 * webweb.display.r * i + initialPushdown + (3 + i) * webweb.display.r;
                            }
                            return initialPushdown;
                        }
                    }
    
                    // show the variable being displayed
                    colorLegend.drawLegendLabel(pushdown);
                    colorLegend.drawLegendText(pushdown, textPushRight);
                    colorLegend.drawLegendValues(
                        pushdown,
                        nodePushRight,
                        function (i) { return webweb.display.r },
                        function (i) { return colorWheel(colorLegend.values[i]); }
                    );
                }
            }
            function Legend(metadataName, legendType, dataType, rawValues) {
                this.metadataName = metadataName;
                this.legendType = legendType;
                this.dataType = dataType;
                this.rawValues = rawValues;
                this.values = [];
    
                legendTypeToLegendMaker = {
                    'size': {
                        'binary': 'makeBinaryLegend',
                        'scalar': 'makeScalarLegend',
                        'degree': 'makeDegreeLegend',
                    },
                    'color': {
                        'binary': 'makeBinaryLegend',
                        'scalar': 'makeScalarLegend',
                        'degree': 'makeDegreeLegend',
                        'categorical': 'makeCategoricalLegend',
                        'scalarCategorical': 'makeScalarCategoricalLegend',
                    },
                }
    
                var legendFunction = legendTypeToLegendMaker[this.legendType][this.dataType];
    
                if (legendFunction !== undefined) {
                    this[legendFunction]();
    
                    if (this.legendType == 'size') {
                        for (var i in this.values) {
                            this.values[i] = webweb.scales.nodeSize(this.values[i]);
                        }
                    }
                }
            }
            Legend.prototype.drawLegendLabel = function (pushDown) {
                var text = new Text(this.metadataName, 5, pushDown(), "12px");
                webweb.legendText.push(text);
            }
            Legend.prototype.drawLegendText = function (pushDown, pushRight) {
                var valuesCount = this.values.length;
                this.text.forEach(function (d, i) {
                    // only draw text for as many values as there are
                    if (i < valuesCount) {
                        var text = new Text(d, pushRight, pushDown(i) + 3.5, "12px");
                        webweb.legendText.push(text);
                    }
                });
            }
            Legend.prototype.drawLegendValues = function (pushDown, pushRight, sizeFunction, colorFunction) {
                var textCount = this.text.length;
                this.values.forEach(function (d, i) {
                    // only draw text for as many values as there are
                    if (i < textCount) {
                        var node = new Node(-1);
                        node.fixedRadius = sizeFunction(d);
                        node.x = pushRight;
                        node.y = pushDown(i);
                        node.__scaledColor = colorFunction(i);
                        node.nonInteractive = true;
    
                        webweb.legendNodes.push(node);
                    }
                });
            }
            Legend.prototype.makeBinaryLegend = function () {
                this.values = getBinaryValues(this.legendType);
                this.text = ["false", "true"];
            }
            Legend.prototype.makeDegreeLegend = function () {
                this.makeScalarLegend();
                if (this.legendType == 'size') {
                    for (var i in this.values) {
                        this.values[i] = Math.sqrt(this.values[i]);
                    }
                }
            }
            Legend.prototype.makeCategoricalLegend = function () {
                this.values = webweb.scales.colors.categorical.domain();
                this.text = d3.values(webweb.allMetadata[webweb.display.colorBy].categories);
            }
            Legend.prototype.makeScalarLegend = function () {
                // if it is integer scalars:
                if (allInts(this.rawValues)) {
                    var max = d3.max(this.rawValues);
                    var min = d3.min(this.rawValues);
    
                    if (max - min <= 8) {
                        this.values = d3.range(min, max + 1);
                    }
                }
    
                if (this.values.length == 0) {
                    this.makeBinnedLegend(4);
                }
    
                this.text = this.values.slice(0);
            }
            // 'bins' a set of values so that we can display a finite legend.
            Legend.prototype.makeBinnedLegend = function (bins) {
                if (bins == undefined) {
                    bins = 4;
                }
                var min_val = d3.min(this.rawValues);
                var max_val = d3.max(this.rawValues);
                var step = (max_val - min_val) / bins;
    
                this.values.push(rounddown(min_val, 10));
    
                for (var i = 1; i < bins; i++) {
                    this.values.push(round(min_val + i * step, 10));
                }
    
                this.values.push(roundup(max_val, 10));
    
                this.text = this.values.slice(0);
            }
            Legend.prototype.makeScalarCategoricalLegend = function (bins) {
                this.makeBinnedLegend();
    
                // this logic is sorta weird; we have converted the categorical information
                // to indexes, but we want the legend to display the actual category values
                // at those indexes
                var categoryValues = d3.set(getRawNodeValues(this.metadataName)).values().sort();
    
                for (var i in this.text) {
                    this.text[i] = categoryValues[parseInt(this.text[i])];
                }
            }
    
            ////////////////////////////////////////////////////////////////////////////////
            //
            //
            //
            //
            // Drawing
            //
            //
            //
            //
            ////////////////////////////////////////////////////////////////////////////////
            function CanvasState(webweb) {
                this.webweb = webweb;
                this.dpr = window.devicePixelRatio || 1;
                this.canvas = document.createElement("canvas");
                this.canvas.id = "webweb-vis-canvas";
    
                this.canvas.style.width = webweb.display.w + "px";
                this.canvas.style.height = webweb.display.h + "px";
    
                this.canvas.width = webweb.display.w * this.dpr;
                this.canvas.height = webweb.display.h * this.dpr;
    
                this.context = this.canvas.getContext('2d');
                this.context.scale(this.dpr, this.dpr);
    
                this.padding = 3;
                this.dragBoundary = 15;
    
                this.dragging = false;
                this.draggedNode = undefined;
    
                this.canvas.addEventListener("mousedown", function (event) {
                    webweb.canvas.mouseDownListener(event);
                });
                this.canvas.addEventListener("mousemove", function (event) {
                    webweb.canvas.mouseMoveListener(event);
                });
                this.canvas.addEventListener("mouseup", function (event) {
                    webweb.canvas.mouseUpListener(event);
                });
            }
    
            CanvasState.prototype.getContext = function () {
                if (this.context == undefined) {
                    this.context = this.canvas.getContext('2d');
                    this.context.scale(this.dpr, this.dpr);
                }
            }
    
            CanvasState.prototype.clear = function () {
                this.context.clearRect(0, 0, webweb.display.w, webweb.display.h);
            }
    
            CanvasState.prototype.redraw = function () {
                this.clear();
                this.webweb.links.forEach(function (link) {
                    link.draw(this.context);
                }, this);
    
                this.webweb.nodeText = [];
                this.webweb.nodes.forEach(function (node) {
                    node.draw(this.context);
                }, this);
                this.webweb.nodeText.forEach(function (text) {
                    text.draw(this.context);
                }, this);
    
                if (this.webweb.display.showLegend) {
                    this.webweb.legendNodes.forEach(function (node) {
                        node.draw(this.context);
                    }, this);
                    this.webweb.legendText.forEach(function (text) {
                        text.draw(this.context);
                    }, this);
                }
            }
    
            CanvasState.prototype.getMouseState = function (event) {
                var container = this.canvas.getBoundingClientRect();
                this.mouseState = {
                    x: event.clientX - container.left - this.padding,
                    y: event.clientY - container.top - this.padding,
                };
            }
    
            CanvasState.prototype.mouseIsWithinDragBoundary = function () {
                if (
                    this.mouseState.x < this.dragBoundary ||
                    this.mouseState.y < this.dragBoundary ||
                    this.mouseState.x > this.webweb.display.w - this.dragBoundary ||
                    this.mouseState.y > this.webweb.display.h - this.dragBoundary
                ) {
                    return true;
                }
                return false;
            }
    
            CanvasState.prototype.endDragging = function () {
                webweb.simulation.alphaTarget(0);
    
                if (!webweb.display.freezeNodeMovement && this.draggedNode !== undefined) {
                    this.draggedNode.fx = null;
                    this.draggedNode.fy = null;
                }
                this.draggedNode = undefined;
                this.dragging = false;
            }
    
            CanvasState.prototype.updateDraggedNode = function () {
                this.draggedNode.x = this.mouseState.x;
                this.draggedNode.y = this.mouseState.y;
                this.draggedNode.fx = this.mouseState.x;
                this.draggedNode.fy = this.mouseState.y;
            }
            CanvasState.prototype.mouseMoveListener = function (event) {
                this.getMouseState(event);
    
                if (this.dragging) {
                    if (this.mouseIsWithinDragBoundary()) {
                        this.endDragging();
                    }
                    else {
                        this.updateDraggedNode();
                    }
                }
    
                this.redraw();
            }
            CanvasState.prototype.mouseDownListener = function (event) {
                this.getMouseState(event);
                this.endDragging();
    
                for (var i in webweb.nodes) {
                    if (webweb.nodes[i].containsMouse()) {
                        this.dragging = true;
                        this.draggedNode = webweb.nodes[i];
    
                        webweb.simulation.alphaTarget(0.3).restart();
    
                        this.updateDraggedNode();
                    }
                }
            }
            CanvasState.prototype.mouseUpListener = function () {
                if (this.dragging) {
                    this.endDragging();
                }
            }
            ////////////////////////////////////////////////////////////////////////////////
            //
            //
            //
            //
            // MENUS
            //
            //
            //
            //
            ////////////////////////////////////////////////////////////////////////////////
            function updateSizeMenu() {
                var sizeSelect = document.getElementById('sizeSelect-widget');
    
                var options = [];
                for (var metadatum in webweb.allMetadata) {
                    if (metadatum == 'name') {
                        continue;
                    }
                    if (webweb.allMetadata[metadatum].categories == undefined) {
                        options.push(metadatum);
                    }
                }
    
                resetSelectOptionsTo(sizeSelect, options);
    
                if (webweb.display.sizeBy == undefined) {
                    webweb.display.sizeBy = 'none';
                }
                else if (webweb.allMetadata[webweb.display.sizeBy] == undefined) {
                    webweb.display.sizeBy = 'none';
                }
    
                sizeSelect = document.getElementById('sizeSelect-widget');
                sizeSelect.value = webweb.display.sizeBy;
                changeSizes(webweb.display.sizeBy);
            }
            function updateColorMenu() {
                var colorSelect = document.getElementById('colorSelect-widget');
    
                var options = [];
                for (var metadatum in webweb.allMetadata) {
                    if (metadatum == 'name') {
                        continue;
                    }
    
                    options.push(metadatum);
                }
    
                resetSelectOptionsTo(colorSelect, options);
    
                if (webweb.display.colorBy == undefined) {
                    webweb.display.colorBy = 'none';
                }
                else if (webweb.allMetadata[webweb.display.colorBy] == undefined) {
                    webweb.display.colorBy = 'none';
                }
    
                colorSelect.value = webweb.display.colorBy;
                changeColors(webweb.display.colorBy);
            }
            function setNetworkLayerMenuVisibility() {
                var visibility = 'inline';
    
                if (wwdata.networks[webweb.display.networkName].layers.length == 1) {
                    visibility = 'none';
                }
    
                document.getElementById('layerSelect-widget').parentElement.style.display = visibility;
            }
            function changeLayer(layer) {
                webweb.display.networkLayer = layer;
    
                var layerSelect = document.getElementById('layerSelect-widget');
                layerSelect.value = webweb.display.networkLayer;
    
                displayNetwork();
            }
            function setInvertBinaryWidgetVisibility(visible, type) {
                var visibility = visible ? 'inline' : 'none';
                var widgetId = getBinaryInversionAttributeForType(type) + "-widget";
    
                var widgetParent = document.getElementById(widgetId).parentElement;
                widgetParent.style.display = visibility;
            }
            function getBinaryInversionAttributeForType(type) {
                if (type == 'color') {
                    return 'invertBinaryColors';
                }
                else if (type == 'size') {
                    return 'invertBinarySizes';
                }
            }
            function setColorPaletteMenuVisibility(visible) {
                var visibility = visible ? 'inline' : 'none';
                document.getElementById('colorPaletteSelect-widget').parentElement.style.display = visibility;
            }
            function resetSelectOptionsTo(select, options) {
                if (select.options !== undefined) {
                    select.options.length = 0;
                }
    
                for (var i in options) {
                    var option = document.createElement('option');
                    option.innerHTML = options[i];
    
                    select.add(option);
                }
    
                return select;
            }
            function writeSimpleWidget(name, _widget) {
                var widget;
    
                if (_widget.type !== undefined && _widget.type == 'select') {
                    widget = document.createElement('select');
                    widget = resetSelectOptionsTo(widget, _widget.options);
                }
                else {
                    widget = document.createElement('input');
                    widget.type = _widget.type || 'text';
                    widget.size = _widget.size || 3;
                }
    
                for (var eventName in _widget.functions) {
                    widget.addEventListener(eventName, function (event) {
                        var value = event.target.value;
                        if (_widget.type !== undefined && _widget.type == 'checkbox') {
                            value = event.target.checked;
                        }
                        _widget.functions[eventName](value);
                    });
                }
    
                widget.id = name + "-widget";
    
                if (_widget.type !== undefined) {
                    if (_widget.type == 'checkbox') {
                        widget.checked = _widget.value ? true : false;
                    }
                    else if (_widget.type == 'select' && _widget.value !== undefined) {
                        for (var i in widget.options) {
                            if (widget.options[i].innerHTML == _widget.value) {
                                widget.options[i].selected = true;
                            }
                        }
                    }
                    else if (_widget.type == 'button') {
                        widget.value = _widget.value;
                    }
                }
                else {
                    widget.value = _widget.value;
                }
    
                var widgetContainerType = _widget.inline ? 'span' : 'div';
                var widgetContainer = document.createElement(widgetContainerType);
    
                if (_widget.text !== undefined) {
                    widgetContainer.innerHTML = _widget.text;
                }
    
                widgetContainer.appendChild(widget);
    
                return widgetContainer;
            }
            function writeMenus(container) {
                var menu = document.createElement('div')
                menu.id = 'webweb-menu';
                menu.style.display = webweb.display.hideMenu == true ? 'none' : 'flex';
                container.appendChild(menu);
    
                var layers = [];
                for (var i in wwdata.networks[webweb.display.networkName].layers) {
                    layers.push(i);
                }
    
                var colorNames = [];
                for (colorName in colorbrewer) {
                    colorNames.push(colorName);
                }
    
                var colorPaletteSelectValue = 'Set1';
                if (webweb.display.colorPalette !== undefined) {
                    if (colorbrewer[webweb.display.colorPalette] !== undefined) {
                        colorPaletteSelectValue = webweb.display.colorPalette;
                    }
                }
    
                var widgetContainers = {
                    'webweb-menu-left': {
                        'network': {
                            'subWidgets': {
                                'layerSelect': {
                                    'text': " layer ",
                                    'type': 'select',
                                    'functions': {
                                        'change': changeLayer,
                                    },
                                    'options': layers,
                                    'value': webweb.display.networkLayer,
                                    'inline': true,
                                },
                            },
                        },
                        'size': {
                            'subWidgets': {
                                'sizeSelect': {
                                    'text': "Scale node sizes by ",
                                    'type': 'select',
                                    'functions': {
                                        'change': changeSizes,
                                    },
                                    'inline': true,
                                },
                                'invertBinarySizes': {
                                    'text': ' invert ',
                                    'type': 'checkbox',
                                    'functions': {
                                        'change': toggleInvertBinarySizes,
                                    },
                                    'value': webweb.display.invertBinarySizes,
                                    'inline': true,
                                },
                            },
                        },
                        'colors': {
                            'subWidgets': {
                                'colorSelect': {
                                    'text': "Color nodes by ",
                                    'type': 'select',
                                    'functions': {
                                        'change': changeColors,
                                    },
                                    'inline': true,
                                },
                                'colorPaletteSelect': {
                                    'text': " with color palette ",
                                    'type': 'select',
                                    'functions': {
                                        'change': setColorPalette,
                                    },
                                    'options': colorNames,
                                    'value': colorPaletteSelectValue,
                                    'inline': true,
                                },
                                'invertBinaryColors': {
                                    'text': ' invert ',
                                    'type': 'checkbox',
                                    'functions': {
                                        'change': toggleInvertBinaryColors,
                                    },
                                    'value': webweb.display.invertBinaryColors,
                                    'inline': true,
                                }
                            },
                        },
                        'scaleLinkWidth': {
                            'text': 'Scale link width ',
                            'type': 'checkbox',
                            'functions': {
                                'change': toggleLinkWidthScaling,
                            },
                            'value': webweb.display.scaleLinkWidth,
                            'size': 10,
                        },
                        'scaleLinkOpacity': {
                            'text': 'Scale link opacity ',
                            'type': 'checkbox',
                            'functions': {
                                'change': toggleLinkOpacityScaling,
                            },
                            'value': webweb.display.scaleLinkOpacity,
                            'size': 10,
                        },
                        'freezeNodes': {
                            'text': 'Freeze nodes ',
                            'type': 'checkbox',
                            'functions': {
                                'change': toggleFreezeNodes,
                            },
                            'value': webweb.display.freezeNodes,
                            'size': 10,
                        },
                        'saveSVG': {
                            'type': 'button',
                            'functions': {
                                'click': writeSVGDownloadLink,
                            },
                            'value': 'Save SVG',
                            'size': 10,
                        },
                    },
                    'webweb-menu-right': {
                        'charge': {
                            'text': 'Node charge: ',
                            'functions': {
                                'change': changeCharge,
                            },
                            'value': webweb.display.c,
                        },
                        'linkLength': {
                            'text': 'Link length: ',
                            'functions': {
                                'change': changeDistance,
                            },
                            'value': webweb.display.l,
                        },
                        'linkStrength': {
                            'text': 'Link strength: ',
                            'functions': {
                                'change': changeLinkStrength,
                            },
                            'value': webweb.display.linkStrength,
                        },
                        'gravity': {
                            'text': 'Gravity: ',
                            'functions': {
                                'change': changeGravity,
                            },
                            'value': webweb.display.g,
                        },
                        'radius': {
                            'text': 'Node radius: ',
                            'functions': {
                                'change': changeR,
                            },
                            'value': webweb.display.r,
                        },
                        'showNodeNames': {
                            'text': 'Show node names ',
                            'type': 'checkbox',
                            'functions': {
                                'input': toggleShowNodeNames,
                            },
                            'value': webweb.display.showNodeNames,
                            'size': 10,
                        },
                        'nameToMatch': {
                            'text': 'Highlight nodes named: ',
                            'functions': {
                                'input': matchNodesNamed,
                            },
                            'value': webweb.display.nameToMatch,
                            'size': 10,
                        },
                    }
                };
    
                for (var side in widgetContainers) {
                    var sideWidgets = widgetContainers[side];
    
                    var sideMenu = document.createElement('div');
                    sideMenu.id = side;
    
                    for (var widgetName in sideWidgets) {
                        var widget;
                        var subWidgets = sideWidgets[widgetName].subWidgets;
                        if (subWidgets !== undefined) {
                            widget = document.createElement('div');
                            for (var subWidgetName in subWidgets) {
                                widget.append(writeSimpleWidget(subWidgetName, subWidgets[subWidgetName]));
                            }
                        }
                        else {
                            widget = writeSimpleWidget(widgetName, sideWidgets[widgetName]);
                        }
    
                        sideMenu.appendChild(widget);
                    }
    
                    menu.appendChild(sideMenu);
                }
            }
            ////////////////////////////////////////////////////////////////////////////////
            //
            //
            //
            // Files
            //
            //
            //
            ////////////////////////////////////////////////////////////////////////////////
            // it's crazy, this function right here, it saves: it
            function saveIt(fileName, fileType, content) {
                try {
                    var isFileSaverSupported = !!new Blob();
                    var blob = new Blob([content], { type: fileType });
                    saveAs(blob, fileName);
                } catch (e) {
                    alert("can't save :(");
                }
            }
            function getSVGHTML() {
                var svg = drawSVG();
                svg.setAttribute("title", webweb.display.networkName);
                svg.setAttribute("version", 1.1);
                svg.setAttribute("xmlns", "http://www.w3.org/2000/svg");
                return svg.outerHTML;
            }
            function writeSVGDownloadLink() {
                html = getSVGHTML();
                saveIt(webweb.display.networkName, "image/svg+xml", html);
            };
            function drawSVG() {
                var svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    
                webweb.links.forEach(function (link) {
                    svg.appendChild(link.drawSVG());
                });
    
                webweb.nodes.forEach(function (node) {
                    svg.appendChild(node.drawSVG());
                });
                webweb.nodeText.forEach(function (text) {
                    svg.appendChild(text.drawSVG());
                });
    
                if (webweb.display.showLegend) {
                    webweb.legendNodes.forEach(function (node) {
                        svg.appendChild(node.drawSVG());
                    });
                    webweb.legendText.forEach(function (text) {
                        svg.appendChild(text.drawSVG());
                    });
                }
    
                return svg;
            }
            ////////////////////////////////////////////////////////////////////////////////
            //
            //
            //
            // Helpers
            //
            //
            //
            ////////////////////////////////////////////////////////////////////////////////
            function isInt(n) {
                return Number(n) === n && n % 1 === 0;
            }
            function isFloat(n) {
                return Number(n) === n && n % 1 !== 0;
            }
            function round(x, dec) {
                return (Math.round(x * dec) / dec);
            }
            function roundup(x, dec) {
                return (Math.ceil(x * dec) / dec);
            }
            function rounddown(x, dec) {
                return (Math.floor(x * dec) / dec);
            }
            function allInts(vals) {
                for (i in vals) {
                    if (!isInt(vals[i])) {
                        return false;
                    }
                }
    
                return true;
            }
            function getObjetPropertyCount(_object) {
                var count = 0;
                for (var property in _object) {
                    if (_object.hasOwnProperty(property)) {
                        count += 1;
                    }
                }
                return count;
            }
            function getTruthinessSafely(variable) {
                if (variable !== undefined && variable == true) {
                    return true;
                }
    
                return false;
            }
            ////////////////////////////////////////////////////////////////////////////////
            //
            //
            //
            // Event Listeners
            //
            //
            //
            ////////////////////////////////////////////////////////////////////////////////
            // binds the up/down arrow keys to change networks
            function changeNetworkListener(event) {
                var currentNetworkIndex = webweb.networkNames.indexOf(webweb.display.networkName);
                var changeToNetworkIndex;
    
                if (event.keyCode == 38) {
                    // up arrow
                    changeToNetworkIndex = currentNetworkIndex - 1;
                }
                else if (event.keyCode == 40) {
                    // down arrow
                    changeToNetworkIndex = currentNetworkIndex + 1;
                }
    
                if (changeToNetworkIndex !== undefined) {
                    if (0 <= changeToNetworkIndex && changeToNetworkIndex < webweb.networkNames.length) {
                        var changeToNetworkName = webweb.networkNames[changeToNetworkIndex];
                        changeNetwork(changeToNetworkName);
                    }
                }
            }
            // binds the left/right arrow keys to change layers
            function changeNetworkLayerListener(event) {
                var currentLayer = webweb.display.networkLayer;
                var changeToLayer;
    
                if (event.keyCode == 39) {
                    // right arrow
                    changeToLayer = currentLayer + 1;
                }
                else if (event.keyCode == 37) {
                    // left arrow
                    changeToLayer = currentLayer - 1;
                }
    
                if (changeToLayer !== undefined) {
                    if (0 <= changeToLayer && changeToLayer < wwdata.networks[webweb.display.networkName].layers.length) {
                        changeLayer(changeToLayer);
                    }
                }
            }
            function playNetworkLayers() {
                window.setTimeout(function () {
                    changeNetworkLayerListener({ 'keyCode': 39 });
                    playNetworkLayers();
                }, 1000);
            }
            ////////////////////////////////////////////////////////////////////////////////
            //
            //
            //
            // Imperial Death March
            //
            //
            //
            ////////////////////////////////////////////////////////////////////////////////
            window.onload = function () {
                initializeWebweb();
            };
            window.addEventListener("keydown", function (event) {
                listeners = {
                    37: changeNetworkLayerListener,
                    38: changeNetworkListener,
                    39: changeNetworkLayerListener,
                    40: changeNetworkListener,
                };
    
                if (event.keyCode in listeners) {
                    listeners[event.keyCode](event);
                }
            });
        </script>
		<!-- #content end -->

		<!-- Footer -->
		<div class="container">
			<footer id="footer" class="light">
				<div id="copyrights">
					<div class="row col-mb-30">
						<div class="col-md-6 text-center text-muted text-md-start">
							Copyrights &copy; 2022 XI GAO | All Rights Reserved<br>
						</div>
						<div class="col-md-6 text-center text-md-end">
							<div class="d-flex justify-content-center justify-content-md-end">
								<ul class="nav col-md-5 justify-content-end list-unstyled d-flex">
									<li class="ms-3"><a class="text-muted"
											href="https://www.instagram.com/gaoxisk8848/"><svg class="bi" width="24"
												height="24">
												<use
													xlink:href="../node_modules/bootstrap-icons/bootstrap-icons.svg#instagram" />
											</svg></a></li>
									<li class="ms-3"><a class="text-muted" href="https://github.com/gaoxisk8"><svg
												class="bi" width="24" height="24">
												<use
													xlink:href="../node_modules/bootstrap-icons/bootstrap-icons.svg#github" />
											</svg></a></li>
								</ul>
							</div>
							<div class="clear"></div>
						</div>

					</div>
				</div>
			</footer>
		</div>
		<!-- #footer end -->
	</div>
	<!-- #wrapper end -->

    <!-- Go To Top -->
    <div id="gotoTop" class="icon-angle-up"></div>
    <!-- Footer Scripts -->
    <script src="./resources/js/functions.js"></script>
</body>

</html>